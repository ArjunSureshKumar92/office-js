var Implicit=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}({"./packages/Microsoft.Office.WebAuth.Implicit/lib/msal.js":function(e,t,r){"use strict";
/*! msal v1.2.0-beta.4 2019-11-15 */
/*! msal v1.2.0-beta.4 2019-11-15 */
var n;window,n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=24)}([function(e,t,r){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function a(e){return this instanceof a?(this.v=e,this):new a(e)}t.__extends=function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},t.__assign=function(){return t.__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.__assign.apply(this,arguments)},t.__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},t.__decorate=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},t.__param=function(e,t){return function(r,n){t(r,n,e)}},t.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},t.__awaiter=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})},t.__generator=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},t.__exportStar=function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},t.__values=o,t.__read=i,t.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},t.__spreadArrays=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},t.__await=a,t.__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||c(e,t)})})}function c(e,t){try{(r=o[e](t)).value instanceof a?Promise.resolve(r.value.v).then(u,l):h(i[0][2],r)}catch(e){h(i[0][3],e)}var r}function u(e){c("next",e)}function l(e){c("throw",e)}function h(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}},t.__asyncDelegator=function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:a(e[n](t)),done:"return"===n}:o?o(t):t}:o}},t.__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=o(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,o,(t=e[r](t)).done,t.value)})}}},t.__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},t.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},t.__importDefault=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e}();t.StringUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}();t.CryptoUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=r(13),i=r(1),a=r(2),s=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(o.ScopeSet.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.getDefaultRedirectUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),o=r.PathSegments;return!t||0===o.length||o[0]!==n.Constants.common&&o[0]!==n.SSOTypes.ORGANIZATIONS||(o[0]=t),this.constructAuthorityUriFromObject(r,o)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),n.PathSegments=o,n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(i.StringUtils.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(n.ServerHashParamKeys.ERROR_DESCRIPTION)||r.hasOwnProperty(n.ServerHashParamKeys.ERROR)||r.hasOwnProperty(n.ServerHashParamKeys.ACCESS_TOKEN)||r.hasOwnProperty(n.ServerHashParamKeys.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return a.CryptoUtils.deserialize(r)},e}();t.UrlUtils=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(){}return Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"consumersUtid",{get:function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();t.Constants=o,function(e){e.CANCELLED="Cancelled",e.COMPLETED="Completed",e.IN_PROGRESS="InProgress"}(t.RequestStatus||(t.RequestStatus={})),function(e){e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(t.ServerHashParamKeys||(t.ServerHashParamKeys={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.ANGULAR_LOGIN_REQUEST="angular.login.request",e.INTERACTION_STATUS="interaction.status"}(t.TemporaryCacheKeys||(t.TemporaryCacheKeys={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.LOGIN_ERROR="login.error"}(t.PersistentCacheKeys||(t.PersistentCacheKeys={})),t.AADTrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier",e.LOGIN_REQ="login_req",e.DOMAIN_REQ="domain_req"}(n=t.SSOTypes||(t.SSOTypes={})),t.BlacklistedEQParams=[n.SID,n.LOGIN_HINT],t.PromptState={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},t.libraryVersion=function(){return"1.2.0-beta.4"}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(6);t.ClientConfigurationErrorMessage={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"}};var i=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createNoSetConfigurationError=function(){return new r(t.ClientConfigurationErrorMessage.configurationNotSet.code,""+t.ClientConfigurationErrorMessage.configurationNotSet.desc)},r.createStorageNotSupportedError=function(e){return new r(t.ClientConfigurationErrorMessage.storageNotSupported.code,t.ClientConfigurationErrorMessage.storageNotSupported.desc+" Given location: "+e)},r.createRedirectCallbacksNotSetError=function(){return new r(t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.code,t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc)},r.createInvalidCallbackObjectError=function(e){return new r(t.ClientConfigurationErrorMessage.invalidCallbackObject.code,t.ClientConfigurationErrorMessage.invalidCallbackObject.desc+" Given value for callback function: "+e)},r.createEmptyScopesArrayError=function(e){return new r(t.ClientConfigurationErrorMessage.emptyScopes.code,t.ClientConfigurationErrorMessage.emptyScopes.desc+" Given value: "+e+".")},r.createScopesNonArrayError=function(e){return new r(t.ClientConfigurationErrorMessage.nonArrayScopes.code,t.ClientConfigurationErrorMessage.nonArrayScopes.desc+" Given value: "+e+".")},r.createClientIdSingleScopeError=function(e){return new r(t.ClientConfigurationErrorMessage.clientScope.code,t.ClientConfigurationErrorMessage.clientScope.desc+" Given value: "+e+".")},r.createScopesRequiredError=function(e){return new r(t.ClientConfigurationErrorMessage.scopesRequired.code,t.ClientConfigurationErrorMessage.scopesRequired.desc+" Given value: "+e)},r.createInvalidPromptError=function(e){return new r(t.ClientConfigurationErrorMessage.invalidPrompt.code,t.ClientConfigurationErrorMessage.invalidPrompt.desc+" Given value: "+e)},r.createClaimsRequestParsingError=function(e){return new r(t.ClientConfigurationErrorMessage.claimsRequestParsingError.code,t.ClientConfigurationErrorMessage.claimsRequestParsingError.desc+" Given value: "+e)},r.createEmptyRequestError=function(){var e=t.ClientConfigurationErrorMessage.emptyRequestError;return new r(e.code,e.desc)},r.createInvalidCorrelationIdError=function(){return new r(t.ClientConfigurationErrorMessage.invalidCorrelationIdError.code,t.ClientConfigurationErrorMessage.invalidCorrelationIdError.desc)},r.createTelemetryConfigError=function(e){var n=t.ClientConfigurationErrorMessage.telemetryConfigError,o=n.code,i=n.desc,a={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new r(o,i+" mising values: "+Object.keys(a).reduce(function(t,r){return e[r]?t:t.concat([r+" ("+a[r]+")"])},[]).join(","))},r}(o.ClientAuthError);t.ClientConfigurationError=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(1);t.ClientAuthErrorMessage={multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required."},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"}};var a=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createEndpointResolutionError=function(e){var n=t.ClientAuthErrorMessage.endpointResolutionError.desc;return e&&!i.StringUtils.isEmpty(e)&&(n+=" Details: "+e),new r(t.ClientAuthErrorMessage.endpointResolutionError.code,n)},r.createMultipleMatchingTokensInCacheError=function(e){return new r(t.ClientAuthErrorMessage.multipleMatchingTokens.code,"Cache error for scope "+e+": "+t.ClientAuthErrorMessage.multipleMatchingTokens.desc+".")},r.createMultipleAuthoritiesInCacheError=function(e){return new r(t.ClientAuthErrorMessage.multipleCacheAuthorities.code,"Cache error for scope "+e+": "+t.ClientAuthErrorMessage.multipleCacheAuthorities.desc+".")},r.createPopupWindowError=function(e){var n=t.ClientAuthErrorMessage.popUpWindowError.desc;return e&&!i.StringUtils.isEmpty(e)&&(n+=" Details: "+e),new r(t.ClientAuthErrorMessage.popUpWindowError.code,n)},r.createTokenRenewalTimeoutError=function(e){var n="URL navigated to is "+e+", "+t.ClientAuthErrorMessage.tokenRenewalError.desc;return new r(t.ClientAuthErrorMessage.tokenRenewalError.code,n)},r.createInvalidIdTokenError=function(e){return new r(t.ClientAuthErrorMessage.invalidIdToken.code,t.ClientAuthErrorMessage.invalidIdToken.desc+" Given token: "+e)},r.createInvalidStateError=function(e,n){return new r(t.ClientAuthErrorMessage.invalidStateError.code,t.ClientAuthErrorMessage.invalidStateError.desc+" "+e+", state expected : "+n+".")},r.createNonceMismatchError=function(e,n){return new r(t.ClientAuthErrorMessage.nonceMismatchError.code,t.ClientAuthErrorMessage.nonceMismatchError.desc+" "+e+", nonce expected : "+n+".")},r.createLoginInProgressError=function(){return new r(t.ClientAuthErrorMessage.loginProgressError.code,t.ClientAuthErrorMessage.loginProgressError.desc)},r.createAcquireTokenInProgressError=function(){return new r(t.ClientAuthErrorMessage.acquireTokenProgressError.code,t.ClientAuthErrorMessage.acquireTokenProgressError.desc)},r.createUserCancelledError=function(){return new r(t.ClientAuthErrorMessage.userCancelledError.code,t.ClientAuthErrorMessage.userCancelledError.desc)},r.createErrorInCallbackFunction=function(e){return new r(t.ClientAuthErrorMessage.callbackError.code,t.ClientAuthErrorMessage.callbackError.desc+" "+e+".")},r.createUserLoginRequiredError=function(){return new r(t.ClientAuthErrorMessage.userLoginRequiredError.code,t.ClientAuthErrorMessage.userLoginRequiredError.desc)},r.createUserDoesNotExistError=function(){return new r(t.ClientAuthErrorMessage.userDoesNotExistError.code,t.ClientAuthErrorMessage.userDoesNotExistError.desc)},r.createClientInfoDecodingError=function(e){return new r(t.ClientAuthErrorMessage.clientInfoDecodingError.code,t.ClientAuthErrorMessage.clientInfoDecodingError.desc+" Failed with error: "+e)},r.createClientInfoNotPopulatedError=function(e){return new r(t.ClientAuthErrorMessage.clientInfoNotPopulatedError.code,t.ClientAuthErrorMessage.clientInfoNotPopulatedError.desc+" Failed with error: "+e)},r.createIdTokenNullOrEmptyError=function(e){return new r(t.ClientAuthErrorMessage.nullOrEmptyIdToken.code,t.ClientAuthErrorMessage.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},r.createIdTokenParsingError=function(e){return new r(t.ClientAuthErrorMessage.idTokenNotParsed.code,t.ClientAuthErrorMessage.idTokenNotParsed.desc+" Failed with error: "+e)},r.createTokenEncodingError=function(e){return new r(t.ClientAuthErrorMessage.tokenEncodingError.code,t.ClientAuthErrorMessage.tokenEncodingError.desc+" Attempted to decode: "+e)},r.createInvalidInteractionTypeError=function(){return new r(t.ClientAuthErrorMessage.invalidInteractionType.code,t.ClientAuthErrorMessage.invalidInteractionType.desc)},r.createCacheParseError=function(e){var n="invalid key: "+e+", "+t.ClientAuthErrorMessage.cacheParseError.desc;return new r(t.ClientAuthErrorMessage.cacheParseError.code,n)},r}(o.AuthError);t.ClientAuthError=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.AuthErrorMessage={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},noWindowObjectError:{code:"no_window_object",desc:"No window object available. Details:"}};var o=function(e){function r(t,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,r.prototype),o.errorCode=t,o.errorMessage=n,o.name="AuthError",o}return n.__extends(r,e),r.createUnexpectedError=function(e){return new r(t.AuthErrorMessage.unexpectedError.code,t.AuthErrorMessage.unexpectedError.desc+": "+e)},r.createNoWindowObjectError=function(e){return new r(t.AuthErrorMessage.noWindowObjectError.code,t.AuthErrorMessage.noWindowObjectError.desc+" "+e)},r}(Error);t.AuthError=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(18),a=r(3);!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C"}(t.AuthorityType||(t.AuthorityType={}));var s=function(){function e(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=a.UrlUtils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=a.UrlUtils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw o.ClientConfigurationErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw o.ClientConfigurationErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw o.ClientConfigurationErrorMessage.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e){return(new i.XhrClient).sendRequestAsync(e,"GET",!0).then(function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}})},e.prototype.resolveEndpointsAsync=function(){return n.__awaiter(this,void 0,Promise,function(){var e,t;return n.__generator(this,function(r){switch(r.label){case 0:return[4,this.GetOpenIdConfigurationEndpointAsync()];case 1:return e=r.sent(),t=this,[4,this.DiscoverEndpoints(e)];case 2:return t.tenantDiscoveryResponse=r.sent(),[2,this]}})})},e}();t.Authority=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_NAME_PREFIX="msal.",t.EVENT_NAME_KEY="event_name",t.START_TIME_KEY="start_time",t.ELAPSED_TIME_KEY="elapsed_time",t.TELEMETRY_BLOB_EVENT_NAMES={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},t.TENANT_PLACEHOLDER="<tenant>"},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(1),i=r(4);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(n=t.LogLevel||(t.LogLevel={}));var a=function(){function e(e,t){void 0===t&&(t={}),this.level=n.Info;var r=t.correlationId,o=void 0===r?"":r,i=t.level,a=void 0===i?n.Info:i,s=t.piiLoggingEnabled,c=void 0!==s&&s;this.localCallback=e,this.correlationId=o,this.level=a,this.piiLoggingEnabled=c}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var a,s=(new Date).toUTCString();a=o.StringUtils.isEmpty(this.correlationId)?s+":"+i.libraryVersion()+"-"+n[e]+" "+t:s+":"+this.correlationId+"-"+i.libraryVersion()+"-"+n[e]+" "+t,this.executeCallback(e,a,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(n.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(n.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(n.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(n.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(n.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(n.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(n.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(n.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}();t.Logger=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7);t.ServerErrorMessage={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}};var i=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createServerUnavailableError=function(){return new r(t.ServerErrorMessage.serverUnavailable.code,t.ServerErrorMessage.serverUnavailable.desc)},r.createUnknownServerError=function(e){return new r(t.ServerErrorMessage.unknownServerError.code,e)},r}(o.AuthError);t.ServerError=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(26),i=r(27),a=r(28),s=r(29),c=r(4),u=r(30),l=r(31),h=r(16),d=r(13),p=r(1),f=r(34),g=r(15),y=r(35),m=r(3),E=r(36),C=r(37),v=r(20),I=r(5),S=r(7),T=r(6),_=r(11),w=r(21),A=r(22),O=n.__importDefault(r(38)),b="https://login.microsoftonline.com/common",P="id_token",R="token",k="id_token token",N=function(){function e(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=v.buildConfiguration(e),this.redirectCallbacksSet=!1,this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),this.authority=this.config.auth.authority||b,this.cacheStorage=new l.AuthCache(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,r=m.UrlUtils.urlContainsHash(t);this.config.framework.isAngular||!r||f.WindowUtils.isInIframe()||f.WindowUtils.isInPopup()||this.handleAuthenticationResponse(t)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=C.AuthorityFactory.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw this.redirectCallbacksSet=!1,I.ClientConfigurationError.createInvalidCallbackObjectError(e);if(t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectCallbacksSet=!0,!this.config.framework.isAngular){var r=this.cacheStorage.getItem(c.TemporaryCacheKeys.URL_HASH);r&&this.processCallBack(r,null)}},e.prototype.authResponseHandler=function(e,t,r){if(e===c.Constants.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==c.Constants.interactionTypePopup)throw T.ClientAuthError.createInvalidInteractionTypeError();r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(e===c.Constants.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,r.accountState):this.authResponseCallback(t,r);else{if(e!==c.Constants.interactionTypePopup)throw T.ClientAuthError.createInvalidInteractionTypeError();n(t)}},e.prototype.loginRedirect=function(e){if(!this.redirectCallbacksSet)throw I.ClientConfigurationError.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(c.Constants.interactionTypeRedirect,!0,e)},e.prototype.acquireTokenRedirect=function(e){if(!e)throw I.ClientConfigurationError.createEmptyRequestError();if(!this.redirectCallbacksSet)throw I.ClientConfigurationError.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(c.Constants.interactionTypeRedirect,!1,e)},e.prototype.loginPopup=function(e){var t=this;return new Promise(function(r,n){t.acquireTokenInteractive(c.Constants.interactionTypePopup,!0,e,r,n)})},e.prototype.acquireTokenPopup=function(e){var t=this;if(!e)throw I.ClientConfigurationError.createEmptyRequestError();return new Promise(function(r,n){t.acquireTokenInteractive(c.Constants.interactionTypePopup,!1,e,r,n)})},e.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i=this;if(this.cacheStorage.getItem(c.TemporaryCacheKeys.INTERACTION_STATUS)!==c.RequestStatus.IN_PROGRESS){var s=t?this.appendScopes(r):r.scopes;this.validateInputScope(s,!t);var u=r&&r.account&&!t?r.account:this.getAccount();if(u||a.ServerRequestParameters.isSSOParam(r))this.acquireTokenHelper(u,e,t,r,s,n,o);else{if(!t)throw this.logger.info("User login is required"),T.ClientAuthError.createUserLoginRequiredError();if(this.extractADALIdToken()&&!s){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken ");var l=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(l).then(function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,n)},function(a){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+a),i.acquireTokenHelper(null,e,t,r,s,n,o)})}else this.acquireTokenHelper(null,e,t,r,s,n,o)}}else{var h=t?T.ClientAuthError.createLoginInProgressError():T.ClientAuthError.createAcquireTokenInProgressError(),d=A.buildResponseStateOnly(this.getAccountState(r&&r.state));this.authErrorHandler(e,h,d,o)}},e.prototype.acquireTokenHelper=function(e,t,r,o,i,s,u){var l=this;this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.IN_PROGRESS);var h,d,p=i?i.join(" ").toLowerCase():this.clientId.toLowerCase(),g=o&&o.authority?C.AuthorityFactory.CreateInstance(o.authority,this.config.auth.validateAuthority):this.authorityInstance;if(t===c.Constants.interactionTypePopup){try{d=this.openPopup("about:blank","msal",c.Constants.popUpWidth,c.Constants.popUpHeight),f.WindowUtils.trackPopup(d)}catch(e){this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.CANCELLED),this.logger.info(T.ClientAuthErrorMessage.popUpWindowError.code+":"+T.ClientAuthErrorMessage.popUpWindowError.desc),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR,T.ClientAuthErrorMessage.popUpWindowError.code),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR_DESC,T.ClientAuthErrorMessage.popUpWindowError.desc),u&&u(T.ClientAuthError.createPopupWindowError())}if(!d)return}g.resolveEndpointsAsync().then(function(){return n.__awaiter(l,void 0,void 0,function(){var l,y,E,C,v;return n.__generator(this,function(n){switch(n.label){case 0:if(l=r?P:this.getTokenType(e,i,!1),r&&((y=this.cacheStorage.getItem(c.TemporaryCacheKeys.ANGULAR_LOGIN_REQUEST))&&""!==y?this.cacheStorage.setItem(c.TemporaryCacheKeys.ANGULAR_LOGIN_REQUEST,""):y=window.location.href),h=new a.ServerRequestParameters(g,this.clientId,l,this.getRedirectUri(o&&o.redirectUri),i,o&&o.state,o&&o.correlationId),this.updateCacheEntries(h,e,y),h.populateQueryParams(e,o),E=m.UrlUtils.createNavigateUrl(h)+c.Constants.response_mode_fragment,t===c.Constants.interactionTypeRedirect)r||this.cacheStorage.setItem(c.TemporaryCacheKeys.STATE_ACQ_TOKEN,h.state,this.inCookie);else{if(t!==c.Constants.interactionTypePopup)throw T.ClientAuthError.createInvalidInteractionTypeError();window.renewStates.push(h.state),window.requestType=r?c.Constants.login:c.Constants.renewToken,this.registerCallback(h.state,p,s,u)}if(this.navigateWindow(E,d),!d)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,f.WindowUtils.monitorWindowForHash(d,this.config.system.loadFrameTimeout,E)];case 2:return C=n.sent(),this.handleAuthenticationResponse(C),this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.COMPLETED),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",C),f.WindowUtils.closePopups()),[3,4];case 3:return v=n.sent(),u&&u(v),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",v.errorCode+c.Constants.resourceDelimiter+v.errorMessage):(this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.CANCELLED),d.close()),[3,4];case 4:return[2]}})})}).catch(function(e){l.logger.warning("could not resolve endpoints"),l.authErrorHandler(t,T.ClientAuthError.createEndpointResolutionError(e.toString),A.buildResponseStateOnly(o.state),u),d&&d.close()})},e.prototype.acquireTokenSilent=function(e){var t=this;if(!e)throw I.ClientConfigurationError.createEmptyRequestError();return new Promise(function(r,n){t.validateInputScope(e.scopes,!0);var o=e.scopes.join(" ").toLowerCase(),i=e.account||t.getAccount(),s=t.cacheStorage.getItem(c.Constants.adalIdToken);if(!i&&!e.sid&&!e.loginHint&&p.StringUtils.isEmpty(s))return t.logger.info("User login is required"),n(T.ClientAuthError.createUserLoginRequiredError());var u=t.getTokenType(i,e.scopes,!0),l=new a.ServerRequestParameters(C.AuthorityFactory.CreateInstance(e.authority,t.config.auth.validateAuthority),t.clientId,u,t.getRedirectUri(e.redirectUri),e.scopes,e.state,e.correlationId);if(a.ServerRequestParameters.isSSOParam(e)||i)l.populateQueryParams(i,e);else if(!i&&!p.StringUtils.isEmpty(s)){var h=g.TokenUtils.extractIdToken(s);t.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken "),l.populateQueryParams(i,null,h)}var d,f,y=e.claimsRequest||l.claimsValue;if(!y&&!e.forceRefresh)try{f=t.getCachedToken(l,i)}catch(e){d=e}if(f)return t.logger.info("Token is already in cache for scope:"+o),r(f),null;if(d)return t.logger.infoPii(d.errorCode+":"+d.errorMessage),n(d),null;var m=void 0;return m=y?"Skipped cache lookup since claims were given.":e.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope:"+o,t.logger.verbose(m),l.authorityInstance||(l.authorityInstance=e.authority?C.AuthorityFactory.CreateInstance(e.authority,t.config.auth.validateAuthority):t.authorityInstance),l.authorityInstance.resolveEndpointsAsync().then(function(){window.activeRenewals[o]?(t.logger.verbose("Renew token for scope: "+o+" is in progress. Registering callback"),t.registerCallback(window.activeRenewals[o],o,r,n)):e.scopes&&e.scopes.indexOf(t.clientId)>-1&&1===e.scopes.length?(t.logger.verbose("renewing idToken"),t.silentLogin=!0,t.renewIdToken(e.scopes,r,n,i,l)):(t.logger.verbose("renewing accesstoken"),t.renewToken(e.scopes,r,n,i,l))}).catch(function(e){return t.logger.warning("could not resolve endpoints"),n(T.ClientAuthError.createEndpointResolutionError(e.toString())),null})})},e.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=a/2-r/2+o,l=s/2-n/2+i,h=window.open(e,t,"width="+r+", height="+n+", top="+l+", left="+u);if(!h)throw T.ClientAuthError.createPopupWindowError();return h.focus&&h.focus(),h}catch(e){throw this.logger.error("error opening popup "+e.message),this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.CANCELLED),T.ClientAuthError.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return n.__awaiter(this,void 0,Promise,function(){var o,i,a,s;return n.__generator(this,function(n){switch(n.label){case 0:return o=window.activeRenewals[r],this.logger.verbose("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem(c.TemporaryCacheKeys.RENEW_STATUS+o,c.RequestStatus.IN_PROGRESS),[4,f.WindowUtils.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)];case 1:i=n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,f.WindowUtils.monitorWindowForHash(i.contentWindow,this.config.system.loadFrameTimeout,e)];case 3:return(a=n.sent())&&this.handleAuthenticationResponse(a),[3,5];case 4:throw s=n.sent(),this.cacheStorage.getItem(c.TemporaryCacheKeys.RENEW_STATUS+o)===c.RequestStatus.IN_PROGRESS&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,s),this.cacheStorage.setItem(c.TemporaryCacheKeys.RENEW_STATUS+o,c.RequestStatus.CANCELLED)),f.WindowUtils.removeHiddenIframe(i),s;case 5:return f.WindowUtils.removeHiddenIframe(i),[2]}})})},e.prototype.navigateWindow=function(e,t){if(!e||p.StringUtils.isEmpty(e))throw this.logger.info("Navigate url is empty"),S.AuthError.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw S.AuthError.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){o.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(){var e=this;this.clearCache(),this.account=null;var t="";this.getPostLogoutRedirectUri()&&(t="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri())),this.authorityInstance.resolveEndpointsAsync().then(function(r){var n=r.EndSessionEndpoint?r.EndSessionEndpoint+"?"+t:e.authority+"oauth2/v2.0/logout?"+t;e.navigateWindow(n)})},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie()},e.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),m.UrlUtils.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("Processing the callback from redirect response"),t||(t=this.getResponseState(e));try{n=this.saveTokenFromHash(e,t)}catch(e){o=e}this.cacheStorage.removeItem(c.TemporaryCacheKeys.URL_HASH);try{this.cacheStorage.clearMsalCookie(t.state);var i=this.getAccountState(t.state);if(n){if(t.requestType===c.Constants.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),n.tokenType=c.ServerHashParamKeys.ACCESS_TOKEN):t.requestType===c.Constants.login&&(n.tokenType=c.ServerHashParamKeys.ID_TOKEN),!r)return void this.authResponseHandler(c.Constants.interactionTypeRedirect,n)}else if(!r)return void this.authErrorHandler(c.Constants.interactionTypeRedirect,o,A.buildResponseStateOnly(i));r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),T.ClientAuthError.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){var t=e||window.location.hash,r=f.WindowUtils.getIframeWithHash(t),n=f.WindowUtils.getPopUpWithHash(t),o=!(!r&&!n),i=this.getResponseState(t),a=null;if(this.logger.info("Returned from redirect url"),o)a=window.callbackMappedToRenewStates[i.state];else{if(a=null,this.config.auth.navigateToLoginRequestUrl){if(this.cacheStorage.setItem(c.TemporaryCacheKeys.URL_HASH,t),window.parent===window){var s=this.cacheStorage.getItem(c.TemporaryCacheKeys.LOGIN_REQUEST,this.inCookie);s&&"null"!==s?window.location.href=s:(this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),window.location.href="/")}return}if(window.location.hash="",!this.redirectCallbacksSet)return void this.cacheStorage.setItem(c.TemporaryCacheKeys.URL_HASH,t)}this.processCallBack(t,i,a),o&&f.WindowUtils.closePopups()},e.prototype.getResponseState=function(e){var t,r=m.UrlUtils.deserializeHash(e);if(!r)throw S.AuthError.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty("state"))throw S.AuthError.createUnexpectedError("Hash does not contain state.");if((t={requestType:c.Constants.unknown,state:r.state,stateMatch:!1}).state===this.cacheStorage.getItem(c.TemporaryCacheKeys.STATE_LOGIN,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=c.Constants.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(c.TemporaryCacheKeys.STATE_ACQ_TOKEN,this.inCookie))return t.requestType=c.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var n=window.renewStates,o=0;o<n.length;o++)if(n[o]===t.state){t.stateMatch=!0;break}}return t},e.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(a=0;a<o.length;a++){l=(s=o[a]).key.scopes.split(" ");d.ScopeSet.containsScope(l,n)&&m.UrlUtils.CanonicalizeUri(s.key.authority)===e.authority&&i.push(s)}if(0===i.length)return null;if(1!==i.length)throw T.ClientAuthError.createMultipleMatchingTokensInCacheError(n.toString());r=i[0]}else{for(var a=0;a<o.length;a++){var s,l=(s=o[a]).key.scopes.split(" ");d.ScopeSet.containsScope(l,n)&&i.push(s)}if(1===i.length)r=i[0],e.authorityInstance=C.AuthorityFactory.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(i.length>1)throw T.ClientAuthError.createMultipleMatchingTokensInCacheError(n.toString());var h=this.getUniqueAuthority(o,"authority");if(h.length>1)throw T.ClientAuthError.createMultipleAuthoritiesInCacheError(n.toString());e.authorityInstance=C.AuthorityFactory.CreateInstance(h[0],this.config.auth.validateAuthority)}}if(null!=r){var p=Number(r.value.expiresIn),f=this.config.system.tokenRenewalOffsetSeconds||300;if(p&&p>y.TimeUtils.now()+f){var g=new u.IdToken(r.value.idToken);if(!t&&!(t=this.getAccount()))throw S.AuthError.createUnexpectedError("Account should not be null here.");var v=this.getAccountState(e.state),I={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?c.ServerHashParamKeys.ID_TOKEN:c.ServerHashParamKeys.ACCESS_TOKEN,idToken:g,idTokenClaims:g.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*p),account:t,accountState:v,fromCache:!0};return E.ResponseUtils.setResponseIdToken(I,g),I}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null}return null},e.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))}),r},e.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(c.Constants.adalIdToken);return p.StringUtils.isEmpty(e)?null:g.TokenUtils.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){var i=e.join(" ").toLowerCase();this.logger.verbose("renewToken is called for scope:"+i);var a="msalRenewFrame"+i,s=f.WindowUtils.addHiddenIFrame(a,this.logger);this.updateCacheEntries(o,n),this.logger.verbose("Renew token Expected state: "+o.state);var u=m.UrlUtils.urlRemoveQueryStringParameter(m.UrlUtils.createNavigateUrl(o),c.Constants.prompt)+c.Constants.prompt_none+c.Constants.response_mode_fragment;window.renewStates.push(o.state),window.requestType=c.Constants.renewToken,this.registerCallback(o.state,i,t,r),this.logger.infoPii("Navigate to:"+u),s.src="about:blank",this.loadIframeTimeout(u,a,i).catch(function(e){return r(e)})},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i=f.WindowUtils.addHiddenIFrame("msalIdTokenFrame",this.logger);this.updateCacheEntries(o,n),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var a=m.UrlUtils.urlRemoveQueryStringParameter(m.UrlUtils.createNavigateUrl(o),c.Constants.prompt)+c.Constants.prompt_none+c.Constants.response_mode_fragment;this.silentLogin?(window.requestType=c.Constants.login,this.silentAuthenticationState=o.state):(window.requestType=c.Constants.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,this.clientId,t,r),this.logger.infoPii("Navigate to:"+a),i.src="about:blank",this.loadIframeTimeout(a,"msalIdTokenFrame",this.clientId).catch(function(e){return r(e)})},e.prototype.saveAccessToken=function(e,t,r,a,u){var l,h,p=n.__assign({},e),f=new s.ClientInfo(a);if(r.hasOwnProperty(c.ServerHashParamKeys.SCOPE)){for(var g=(l=r[c.ServerHashParamKeys.SCOPE]).split(" "),m=this.cacheStorage.getAllAccessTokens(this.clientId,t),E=0;E<m.length;E++){var C=m[E];if(C.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var v=C.key.scopes.split(" ");d.ScopeSet.isIntersectingScopes(v,g)&&this.cacheStorage.removeItem(JSON.stringify(C.key))}}var I=y.TimeUtils.parseExpiresIn(r[c.ServerHashParamKeys.EXPIRES_IN]);h=y.TimeUtils.now()+I;var S=new o.AccessTokenKey(t,this.clientId,l,f.uid,f.utid),T=new i.AccessTokenValue(r[c.ServerHashParamKeys.ACCESS_TOKEN],u.rawIdToken,h.toString(),a);this.cacheStorage.setItem(JSON.stringify(S),JSON.stringify(T)),p.accessToken=r[c.ServerHashParamKeys.ACCESS_TOKEN],p.scopes=g}else{l=this.clientId;S=new o.AccessTokenKey(t,this.clientId,l,f.uid,f.utid);h=Number(u.expiration);T=new i.AccessTokenValue(r[c.ServerHashParamKeys.ID_TOKEN],r[c.ServerHashParamKeys.ID_TOKEN],h.toString(),a);this.cacheStorage.setItem(JSON.stringify(S),JSON.stringify(T)),p.scopes=[l],p.accessToken=r[c.ServerHashParamKeys.ID_TOKEN]}return h?p.expiresOn=new Date(1e3*h):this.logger.error("Could not parse expiresIn parameter"),p},e.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=m.UrlUtils.deserializeHash(e),i="",a="",d=null;if(o.hasOwnProperty(c.ServerHashParamKeys.ERROR_DESCRIPTION)||o.hasOwnProperty(c.ServerHashParamKeys.ERROR)){if(this.logger.infoPii("Error :"+o[c.ServerHashParamKeys.ERROR]+"; Error description:"+o[c.ServerHashParamKeys.ERROR_DESCRIPTION]),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR,o[c.ServerHashParamKeys.ERROR]),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR_DESC,o[c.ServerHashParamKeys.ERROR_DESCRIPTION]),t.requestType===c.Constants.login&&(this.cacheStorage.setItem(c.PersistentCacheKeys.LOGIN_ERROR,o[c.ServerHashParamKeys.ERROR_DESCRIPTION]+":"+o[c.ServerHashParamKeys.ERROR]),i=l.AuthCache.generateAuthorityKey(t.state)),t.requestType===c.Constants.renewToken){i=l.AuthCache.generateAuthorityKey(t.state);var f=this.getAccount(),g=void 0;g=f&&!p.StringUtils.isEmpty(f.homeAccountIdentifier)?f.homeAccountIdentifier:c.Constants.no_account,a=l.AuthCache.generateAcquireTokenAccountKey(g,t.state)}var y=o[c.ServerHashParamKeys.ERROR],C=o[c.ServerHashParamKeys.ERROR_DESCRIPTION];r=w.InteractionRequiredAuthError.isInteractionRequiredError(y)||w.InteractionRequiredAuthError.isInteractionRequiredError(C)?new w.InteractionRequiredAuthError(o[c.ServerHashParamKeys.ERROR],o[c.ServerHashParamKeys.ERROR_DESCRIPTION]):new _.ServerError(o[c.ServerHashParamKeys.ERROR],o[c.ServerHashParamKeys.ERROR_DESCRIPTION])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(c.ServerHashParamKeys.SESSION_STATE)&&this.cacheStorage.setItem(c.TemporaryCacheKeys.SESSION_STATE,o[c.ServerHashParamKeys.SESSION_STATE]),n.accountState=this.getAccountState(t.state);var v="";if(o.hasOwnProperty(c.ServerHashParamKeys.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),o.hasOwnProperty(c.ServerHashParamKeys.ID_TOKEN)?(d=new u.IdToken(o[c.ServerHashParamKeys.ID_TOKEN]),n.idToken=d,n.idTokenClaims=d.claims):(d=new u.IdToken(this.cacheStorage.getItem(c.PersistentCacheKeys.IDTOKEN)),n=E.ResponseUtils.setResponseIdToken(n,d));var I=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);if(!o.hasOwnProperty(c.ServerHashParamKeys.CLIENT_INFO))throw this.logger.warning("ClientInfo not received in the response from AAD"),T.ClientAuthError.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");v=o[c.ServerHashParamKeys.CLIENT_INFO],n.account=h.Account.createAccount(d,new s.ClientInfo(v));var A=void 0;A=n.account&&!p.StringUtils.isEmpty(n.account.homeAccountIdentifier)?n.account.homeAccountIdentifier:c.Constants.no_account,a=l.AuthCache.generateAcquireTokenAccountKey(A,t.state);var O=l.AuthCache.generateAcquireTokenAccountKey(c.Constants.no_account,t.state),b=this.cacheStorage.getItem(a),P=void 0;p.StringUtils.isEmpty(b)?p.StringUtils.isEmpty(this.cacheStorage.getItem(O))||(n=this.saveAccessToken(n,I,o,v,d)):(P=JSON.parse(b),n.account&&P&&h.Account.compareAccounts(n.account,P)?(n=this.saveAccessToken(n,I,o,v,d),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(c.ServerHashParamKeys.ID_TOKEN)){this.logger.info("Fragment has id token"),d=new u.IdToken(o[c.ServerHashParamKeys.ID_TOKEN]),n=E.ResponseUtils.setResponseIdToken(n,d),o.hasOwnProperty(c.ServerHashParamKeys.CLIENT_INFO)?v=o[c.ServerHashParamKeys.CLIENT_INFO]:this.logger.warning("ClientInfo not received in the response from AAD");I=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);this.account=h.Account.createAccount(d,new s.ClientInfo(v)),n.account=this.account,d&&d.nonce?d.nonce!==this.cacheStorage.getItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+t.state,this.inCookie)?(this.account=null,this.cacheStorage.setItem(c.PersistentCacheKeys.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+t.state,this.inCookie)+",Actual Nonce: "+d.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+t.state,this.inCookie)+",Actual Nonce: "+d.nonce),r=T.ClientAuthError.createNonceMismatchError(this.cacheStorage.getItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+t.state,this.inCookie),d.nonce)):(this.cacheStorage.setItem(c.PersistentCacheKeys.IDTOKEN,o[c.ServerHashParamKeys.ID_TOKEN]),this.cacheStorage.setItem(c.PersistentCacheKeys.CLIENT_INFO,v),this.saveAccessToken(n,I,o,v,d)):(i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=T.ClientAuthError.createInvalidIdTokenError(d),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR_DESC,r.errorMessage))}}else{i=t.state,a=t.state;var R=this.cacheStorage.getItem(c.TemporaryCacheKeys.STATE_LOGIN,this.inCookie);this.logger.error("State Mismatch.Expected State: "+R+",Actual State: "+t.state),r=T.ClientAuthError.createInvalidStateError(t.state,R),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.COMPLETED),this.cacheStorage.setItem(c.TemporaryCacheKeys.RENEW_STATUS+t.state,c.RequestStatus.COMPLETED),this.cacheStorage.removeAcquireTokenEntries(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.CANCELLED),this.cacheStorage.setItem(c.TemporaryCacheKeys.RENEW_STATUS+t.state,c.RequestStatus.CANCELLED),this.cacheStorage.removeAcquireTokenEntries(t.state),r;if(!n)throw S.AuthError.createUnexpectedError("Response is null");return n},e.prototype.populateAuthority=function(e,t,r,n){var o=l.AuthCache.generateAuthorityKey(e),i=r.getItem(o,t);return p.StringUtils.isEmpty(i)?i:m.UrlUtils.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(c.PersistentCacheKeys.IDTOKEN),t=this.cacheStorage.getItem(c.PersistentCacheKeys.CLIENT_INFO);if(!p.StringUtils.isEmpty(e)&&!p.StringUtils.isEmpty(t)){var r=new u.IdToken(e),n=new s.ClientInfo(t);return this.account=h.Account.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=new u.IdToken(t[r].value.idToken),o=new s.ClientInfo(t[r].value.homeAccountIdentifier),i=h.Account.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw I.ClientConfigurationError.createScopesNonArrayError(e);if(e.length<1)throw I.ClientConfigurationError.createEmptyScopesArrayError(e.toString());if(e.indexOf(this.clientId)>-1&&e.length>1)throw I.ClientConfigurationError.createClientIdSingleScopeError(e.toString())}else if(t)throw I.ClientConfigurationError.createScopesRequiredError(e)},e.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.appendScopes=function(e){var t;return e&&e.scopes&&(t=e.extraScopesToConsent?e.scopes.concat(e.extraScopesToConsent):e.scopes),t},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:C.AuthorityFactory.CreateInstance(this.authority,this.config.auth.validateAuthority),s=this.getTokenType(o,e,!0),c=new a.ServerRequestParameters(i,this.clientId,s,this.getRedirectUri(),e,r,n);return this.getCachedToken(c,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this.getHostFromUri(e)===this.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return!!this.cacheStorage.getItem(c.TemporaryCacheKeys.URL_HASH)||this.cacheStorage.getItem(c.TemporaryCacheKeys.INTERACTION_STATUS)===c.RequestStatus.IN_PROGRESS},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.IN_PROGRESS):this.cacheStorage.removeItem(c.TemporaryCacheKeys.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(c.TemporaryCacheKeys.INTERACTION_STATUS)===c.RequestStatus.IN_PROGRESS},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.config.system.logger},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw I.ClientConfigurationError.createNoSetConfigurationError();return this.config},e.prototype.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e.prototype.getTokenType=function(e,t,r){return r?h.Account.compareAccounts(e,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?P:R:t.indexOf(this.config.auth.clientId)>-1?P:k:h.Account.compareAccounts(e,this.getAccount())?t.indexOf(this.clientId)>-1?P:R:k},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):c.Constants.no_account,n=l.AuthCache.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=l.AuthCache.generateAuthorityKey(e);this.cacheStorage.setItem(r,m.UrlUtils.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r){r?(this.cacheStorage.setItem(c.TemporaryCacheKeys.LOGIN_REQUEST,r,this.inCookie),this.cacheStorage.setItem(c.TemporaryCacheKeys.STATE_LOGIN,e.state,this.inCookie)):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+e.state,e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return p.StringUtils.isEmpty(e.homeAccountIdentifier)?c.Constants.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return null;var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw I.ClientConfigurationError.createTelemetryConfigError(e);var i={platform:{sdk:"msal.js",sdkVersion:c.libraryVersion(),applicationName:r,applicationVersion:n},clientId:t};return new O.default(i,o)},e}();t.UserAgentApplication=N},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var r=0;r<t.length;r++)if(e.indexOf(t[r].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every(function(t){return e.indexOf(t.toString().toLowerCase())>=0})},e.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase()})},e.removeElement=function(e,t){return e.filter(function(e){return e!==t})},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e}();t.ScopeSet=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.validateClaimsRequest=function(e){if(e.claimsRequest)try{JSON.parse(e.claimsRequest)}catch(e){throw n.ClientConfigurationError.createClaimsRequestParsingError(e)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(1),i=function(){function e(){}return e.decodeJwt=function(e){if(o.StringUtils.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=n.CryptoUtils.base64Decode(r);return o?JSON.parse(o):null}catch(e){}return null},e}();t.TokenUtils=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(1),i=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var i,a=t.objectId||t.subject,s=r?r.uid:"",c=r?r.utid:"";return o.StringUtils.isEmpty(s)||o.StringUtils.isEmpty(c)||(i=n.CryptoUtils.base64Encode(s)+"."+n.CryptoUtils.base64Encode(c)),new e(a,i,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}();t.Account=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(18),a=r(4),s=function(e){function t(t,r){return e.call(this,t,r)||this}return n.__extends(t,e),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return o.AuthorityType.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(e){return!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.DefaultOpenIdConfigurationEndpoint]:[2,(new i.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return e.tenant_discovery_endpoint})]})})},t.prototype.IsInTrustedHostList=function(e){return a.AADTrustedHostList[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t}(o.Authority);t.AadAuthority=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise(function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){var t;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{t=JSON.parse(i.responseText)}catch(e){o(n.handleError(i.responseText))}r(t)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}();t.XhrClient=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(17),i=r(8),a=r(5),s=r(3),c=function(e){function t(t,r){var n=e.call(this,t,r)||this,o=s.UrlUtils.GetUrlComponents(t),i=o.PathSegments;if(i.length<3)throw a.ClientConfigurationErrorMessage.b2cAuthorityUriInvalidPath;return n.CanonicalAuthority="https://"+o.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",n}return n.__extends(t,e),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return i.AuthorityType.B2C},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(e){if(!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort))return[2,this.DefaultOpenIdConfigurationEndpoint];throw a.ClientConfigurationErrorMessage.unsupportedAuthorityValidation})})},t.B2C_PREFIX="tfp",t}(o.AadAuthority);t.B2cAuthority=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(10),i=r(3),a={clientId:"",authority:null,validateAuthority:!0,redirectUri:function(){return i.UrlUtils.getDefaultRedirectUri()},postLogoutRedirectUri:function(){return i.UrlUtils.getDefaultRedirectUri()},navigateToLoginRequestUrl:!0},s={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},c={logger:new o.Logger(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},u={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};t.buildConfiguration=function(e){var t=e.auth,r=e.cache,o=void 0===r?{}:r,i=e.system,l=void 0===i?{}:i,h=e.framework,d=void 0===h?{}:h;return{auth:n.__assign({},a,t),cache:n.__assign({},s,o),system:n.__assign({},c,l),framework:n.__assign({},u,d)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(11);t.InteractionRequiredAuthErrorMessage={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}};var i=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.isInteractionRequiredError=function(e){var r=[t.InteractionRequiredAuthErrorMessage.interactionRequired.code,t.InteractionRequiredAuthErrorMessage.consentRequired.code,t.InteractionRequiredAuthErrorMessage.loginRequired.code];return e&&r.indexOf(e)>-1},r.createLoginRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.loginRequired.code,e)},r.createInteractionRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.interactionRequired.code,e)},r.createConsentRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.consentRequired.code,e)},r}(o.ServerError);t.InteractionRequiredAuthError=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.buildResponseStateOnly=function(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=r(4),i=r(9),a=r(2),s=r(3);t.scrubTenantFromUri=function(e){var t=s.UrlUtils.GetUrlComponents(e);if(!o.AADTrustedHostList[t.HostNameAndPort.toLocaleLowerCase()])return null;var r=t.PathSegments;if(r&&r.length>=2){var a=r[1]===n.B2cAuthority.B2C_PREFIX?2:1;a<r.length&&(r[a]=i.TENANT_PLACEHOLDER)}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},t.hashPersonalIdentifier=function(e){return a.CryptoUtils.base64Encode(e)},t.prependEventNamePrefix=function(e){return""+i.EVENT_NAME_PREFIX+(e||"")}},function(e,t,r){e.exports=r(25)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(12);t.UserAgentApplication=n.UserAgentApplication;var o=r(10);t.Logger=o.Logger;var i=r(10);t.LogLevel=i.LogLevel;var a=r(16);t.Account=a.Account;var s=r(4);t.Constants=s.Constants;var c=r(8);t.Authority=c.Authority;var u=r(12);t.CacheResult=u.CacheResult;var l=r(20);t.CacheLocation=l.CacheLocation,t.Configuration=l.Configuration;var h=r(14);t.AuthenticationParameters=h.AuthenticationParameters;var d=r(22);t.AuthResponse=d.AuthResponse;var p=r(2);t.CryptoUtils=p.CryptoUtils;var f=r(7);t.AuthError=f.AuthError;var g=r(6);t.ClientAuthError=g.ClientAuthError;var y=r(11);t.ServerError=y.ServerError;var m=r(5);t.ClientConfigurationError=m.ClientConfigurationError;var E=r(21);t.InteractionRequiredAuthError=E.InteractionRequiredAuthError},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(3),i=function(){return function(e,t,r,i,a){this.authority=o.UrlUtils.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=n.CryptoUtils.base64Encode(i)+"."+n.CryptoUtils.base64Encode(a)}}();t.AccessTokenKey=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n}}();t.AccessTokenValue=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(14),i=r(4),a=r(5),s=r(1),c=function(){function e(e,t,r,o,a,s,c){this.authorityInstance=e,this.clientId=t,this.nonce=n.CryptoUtils.createNewGuid(),this.setRequestServerParams(a,s,c,this.clientId),this.xClientSku="MSAL.JS",this.xClientVer=i.libraryVersion(),this.responseType=r,this.redirectUri=o}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n){var i,a={};r&&(r.prompt&&(this.validatePromptParameter(r.prompt),this.promptValue=r.prompt),r.claimsRequest&&(o.validateClaimsRequest(r),this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(a=this.constructUnifiedCacheQueryParameter(r,null))),n&&(a=this.constructUnifiedCacheQueryParameter(null,n)),a=this.addHintParameters(t,a),r&&(i=this.sanitizeEQParams(r)),this.queryParameters=e.generateQueryParametersString(a),this.extraQueryParameters=e.generateQueryParametersString(i)},e.prototype.validatePromptParameter=function(e){if([i.PromptState.LOGIN,i.PromptState.SELECT_ACCOUNT,i.PromptState.CONSENT,i.PromptState.NONE].indexOf(e)<0)throw a.ClientConfigurationError.createInvalidPromptError(e)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n,o={};if(e)if(e.account){var a=e.account;a.sid?(r=i.SSOTypes.SID,n=a.sid):a.userName&&(r=i.SSOTypes.LOGIN_HINT,n=a.userName)}else e.sid?(r=i.SSOTypes.SID,n=e.sid):e.loginHint&&(r=i.SSOTypes.LOGIN_HINT,n=e.loginHint);else t&&(t.hasOwnProperty(i.Constants.upn)?(r=i.SSOTypes.ID_TOKEN,n=t.upn):(r=i.SSOTypes.ORGANIZATIONS,n=null));return o=this.addSSOParameter(r,n),e&&e.account&&e.account.homeAccountIdentifier&&(o=this.addSSOParameter(i.SSOTypes.HOMEACCOUNT_ID,e.account.homeAccountIdentifier,o)),o},e.prototype.addHintParameters=function(e,t){if(e&&!t[i.SSOTypes.SID]){if(!t[i.SSOTypes.LOGIN_HINT]&&e.sid&&this.promptValue===i.PromptState.NONE)t=this.addSSOParameter(i.SSOTypes.SID,e.sid,t);else!t[i.SSOTypes.LOGIN_HINT]&&e.userName&&!s.StringUtils.isEmpty(e.userName)&&(t=this.addSSOParameter(i.SSOTypes.LOGIN_HINT,e.userName,t));!t[i.SSOTypes.DOMAIN_REQ]&&!t[i.SSOTypes.LOGIN_REQ]&&(t=this.addSSOParameter(i.SSOTypes.HOMEACCOUNT_ID,e.homeAccountIdentifier,t))}return t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case i.SSOTypes.SID:r[i.SSOTypes.SID]=t;break;case i.SSOTypes.ID_TOKEN:r[i.SSOTypes.LOGIN_HINT]=t,r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.ORGANIZATIONS;break;case i.SSOTypes.LOGIN_HINT:r[i.SSOTypes.LOGIN_HINT]=t;break;case i.SSOTypes.ORGANIZATIONS:r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.ORGANIZATIONS;break;case i.SSOTypes.CONSUMERS:r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.CONSUMERS;break;case i.SSOTypes.HOMEACCOUNT_ID:var o=t.split("."),a=n.CryptoUtils.base64Decode(o[0]),s=n.CryptoUtils.base64Decode(o[1]);r[i.SSOTypes.LOGIN_REQ]=a,r[i.SSOTypes.DOMAIN_REQ]=s,s===i.Constants.consumersUtid?r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.CONSUMERS:r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.ORGANIZATIONS;break;case i.SSOTypes.LOGIN_REQ:r[i.SSOTypes.LOGIN_REQ]=t;break;case i.SSOTypes.DOMAIN_REQ:r[i.SSOTypes.DOMAIN_REQ]=t}return r},e.prototype.sanitizeEQParams=function(e){var t=e.extraQueryParameters;return t?(e.claimsRequest&&delete t[i.Constants.claims],i.BlacklistedEQParams.forEach(function(e){t[e]&&delete t[e]}),t):null},e.generateQueryParametersString=function(e){var t=null;return e&&Object.keys(e).forEach(function(r){null==t?t=r+"="+encodeURIComponent(e[r]):t+="&"+r+"="+encodeURIComponent(e[r])}),t},e.prototype.setRequestServerParams=function(e,t,r,o){if(this.scopes=e?e.slice():[o],this.state=t&&!s.StringUtils.isEmpty(t)?n.CryptoUtils.createNewGuid()+"|"+t:n.CryptoUtils.createNewGuid(),r&&!n.CryptoUtils.isGuid(r))throw a.ClientConfigurationError.createInvalidCorrelationIdError();this.correlationId=r&&n.CryptoUtils.isGuid(r)?r:n.CryptoUtils.createNewGuid()},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e}();t.ServerRequestParameters=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(6),i=r(1),a=function(){function e(e){if(!e||i.StringUtils.isEmpty(e))return this.uid="",void(this.utid="");try{var t=n.CryptoUtils.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw o.ClientAuthError.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}();t.ClientInfo=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(15),i=r(1),a=function(){return function(e){if(i.StringUtils.isEmpty(e))throw n.ClientAuthError.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=o.TokenUtils.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw n.ClientAuthError.createIdTokenParsingError(e)}}}();t.IdToken=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=r(32),a=r(33),s=r(6),c=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return n.__extends(t,e),t.prototype.migrateCacheEntries=function(t){var r=this,n=o.Constants.cachePrefix+"."+o.PersistentCacheKeys.IDTOKEN,i=o.Constants.cachePrefix+"."+o.PersistentCacheKeys.CLIENT_INFO,a=o.Constants.cachePrefix+"."+o.PersistentCacheKeys.ERROR,s=o.Constants.cachePrefix+"."+o.PersistentCacheKeys.ERROR_DESC,c=[e.prototype.getItem.call(this,n),e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,a),e.prototype.getItem.call(this,s)];[o.PersistentCacheKeys.IDTOKEN,o.PersistentCacheKeys.CLIENT_INFO,o.PersistentCacheKeys.ERROR,o.PersistentCacheKeys.ERROR_DESC].forEach(function(e,n){return r.duplicateCacheEntry(e,c[n],t)})},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+o.Constants.cachePrefix)||0===e.indexOf(o.PersistentCacheKeys.ADAL_ID_TOKEN)?e:t?o.Constants.cachePrefix+"."+this.clientId+"."+e:o.Constants.cachePrefix+"."+e}},t.prototype.setItem=function(t,r,n){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(o.Constants.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllAccessTokens=function(e,t){var r=this;return Object.keys(window[this.cacheLocation]).reduce(function(n,a){if(a.match(e)&&a.match(t)&&a.match(o.Constants.scopes)){var c=r.getItem(a);if(c)try{var u=JSON.parse(a),l=new i.AccessTokenCacheItem(u,JSON.parse(c));return n.concat([l])}catch(e){throw s.ClientAuthError.createCacheParseError(a)}}return n},[])},t.prototype.removeAcquireTokenEntries=function(e){var t,r=window[this.cacheLocation];for(t in r)if(r.hasOwnProperty(t)&&!(-1===t.indexOf(o.TemporaryCacheKeys.AUTHORITY)&&1===t.indexOf(o.TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT)||e&&-1===t.indexOf(e))){var n=t.split(o.Constants.resourceDelimiter),i=void 0;n.length>1&&(i=n[n.length-1]),i!==e||this.tokenRenewalInProgress(i)||(this.removeItem(t),this.removeItem(o.TemporaryCacheKeys.RENEW_STATUS+e),this.removeItem(o.TemporaryCacheKeys.STATE_LOGIN),this.removeItem(o.TemporaryCacheKeys.STATE_ACQ_TOKEN),this.removeItem(o.TemporaryCacheKeys.LOGIN_REQUEST),this.removeItem(o.TemporaryCacheKeys.INTERACTION_STATUS),this.removeItem(o.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+e),this.setItemCookie(t,"",-1),this.clearMsalCookie(e))}},t.prototype.tokenRenewalInProgress=function(e){var t=this.getItem(o.TemporaryCacheKeys.RENEW_STATUS+e);return!(!t||t!==o.RequestStatus.IN_PROGRESS)},t.prototype.clearMsalCookie=function(e){var t=e?o.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+e:o.TemporaryCacheKeys.NONCE_IDTOKEN;this.clearItemCookie(t),this.clearItemCookie(o.TemporaryCacheKeys.STATE_LOGIN),this.clearItemCookie(o.TemporaryCacheKeys.LOGIN_REQUEST),this.clearItemCookie(o.TemporaryCacheKeys.STATE_ACQ_TOKEN)},t.generateAcquireTokenAccountKey=function(e,t){return""+o.TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT+o.Constants.resourceDelimiter+e+o.Constants.resourceDelimiter+t},t.generateAuthorityKey=function(e){return""+o.TemporaryCacheKeys.AUTHORITY+o.Constants.resourceDelimiter+e},t}(a.BrowserStorage);t.AuthCache=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t){this.key=e,this.value=t}}();t.AccessTokenCacheItem=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(7),i=function(){function e(e){if(!window)throw o.AuthError.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!=window[e]))throw n.ClientConfigurationError.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}();t.BrowserStorage=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(3),i=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.monitorWindowForHash=function(t,r,i){return new Promise(function(a,s){var c=r/e.POLLING_INTERVAL_MS,u=0,l=setInterval(function(){if(t.closed)return clearInterval(l),void s(n.ClientAuthError.createUserCancelledError());var e;try{e=t.location.href}catch(e){}e&&"about:blank"!==e&&(u++,o.UrlUtils.urlContainsHash(e)?(clearInterval(l),a(t.location.hash)):u>c&&(clearInterval(l),s(n.ClientAuthError.createTokenRenewalTimeoutError(i))))},e.POLLING_INTERVAL_MS)})},e.loadFrame=function(t,r,n,o){return o.info("LoadFrame: "+r),new Promise(function(i,a){setTimeout(function(){var n=e.addHiddenIFrame(r,o);n?(""!==n.src&&"about:blank"!==n.src||(n.src=t,o.infoPii("Frame Name : "+r+" Navigated to: "+t)),i(n)):a("Unable to load iframe with name: "+r)},n)})},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.info("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},e.removeHiddenIframe=function(e){document.body!==e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,r){return t.item(r)}).filter(function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}})[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter(function(e){try{return e.location.hash===t}catch(e){return!1}})[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach(function(e){return e.close()})},e.POLLING_INTERVAL_MS=50,e}();t.WindowUtils=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e}();t.TimeUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),n.__assign({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e}();t.ResponseUtils=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(17),o=r(19),i=r(8),a=r(5),s=r(3),c=r(1),u=function(){function e(){}return e.DetectAuthorityFromUrl=function(e){switch(e=s.UrlUtils.CanonicalizeUri(e),s.UrlUtils.GetUrlComponents(e).PathSegments[0]){case"tfp":return i.AuthorityType.B2C;default:return i.AuthorityType.Aad}},e.CreateInstance=function(t,r){if(c.StringUtils.isEmpty(t))return null;switch(e.DetectAuthorityFromUrl(t)){case i.AuthorityType.B2C:return new o.B2cAuthority(t,r);case i.AuthorityType.Aad:return new n.AadAuthority(t,r);default:throw a.ClientConfigurationErrorMessage.invalidAuthorityType}},e}();t.AuthorityFactory=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0).__importDefault(r(39)),o=function(e){return e.telemetryCorrelationId+"-"+e.eventId+"-"+e.eventName},i=function(){function e(e,t){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=e.platform,this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t}return e.prototype.startEvent=function(e){if(this.telemetryEmitter){var t=o(e);this.inProgressEvents[t]=e}},e.prototype.stopEvent=function(e){var t=o(e);if(this.telemetryEmitter&&this.inProgressEvents[t]){e.stop(),this.incrementEventCount(e);var r=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(r||[]).concat([e]),delete this.inProgressEvents[t]}},e.prototype.flush=function(e){var t=this;if(this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return t.incrementEventCount(e)});var o=this.completedEvents[e].concat(r);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],o&&o.length){var a=new n.default(this.telemetryPlatform,e,this.clientId,i),s=o.concat([a]);this.telemetryEmitter(s.map(function(e){return e.get()}))}}},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])}return r},[])},e}();t.default=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=n.__importDefault(r(40)),a=r(23),s=function(e){function t(t,r,n,i){var s=e.call(this,a.prependEventNamePrefix("default_event"),r)||this;return s.event[a.prependEventNamePrefix("client_id")]=n,s.event[a.prependEventNamePrefix("sdk_plaform")]=t.sdk,s.event[a.prependEventNamePrefix("sdk_version")]=t.sdkVersion,s.event[a.prependEventNamePrefix("application_name")]=t.applicationName,s.event[a.prependEventNamePrefix("application_version")]=t.applicationVersion,s.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.UiEventCountTelemetryBatchKey]=s.getEventCount(a.prependEventNamePrefix("ui_event"),i),s.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.HttpEventCountTelemetryBatchKey]=s.getEventCount(a.prependEventNamePrefix("http_event"),i),s.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.CacheEventCountConstStrKey]=s.getEventCount(a.prependEventNamePrefix("cache_event"),i),s}return n.__extends(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(i.default);t.default=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(9),a=r(23),s=r(2),c=function(){function e(e,t){var r;this.startTimestamp=Date.now(),this.eventId=s.CryptoUtils.createNewGuid(),this.event=((r={})[a.prependEventNamePrefix(i.EVENT_NAME_KEY)]=e,r[a.prependEventNamePrefix(i.START_TIME_KEY)]=this.startTimestamp,r[a.prependEventNamePrefix(i.ELAPSED_TIME_KEY)]=-1,r[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=t,r)}return e.prototype.setElapsedTime=function(e){this.event[a.prependEventNamePrefix(i.ELAPSED_TIME_KEY)]=e},e.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[a.prependEventNamePrefix(i.EVENT_NAME_KEY)]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return n.__assign({},this.event,{eventId:this.eventId})},e}();t.default=c}])},e.exports=n()},"./packages/Microsoft.Office.WebAuth.Implicit/lib/msal.min.js":function(e,t,r){"use strict";
/*! msal v1.2.0-beta.4 2019-11-15 */window,e.exports=function(){return r={},e.m=t=[function(e,t,r){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function a(e){return this instanceof a?(this.v=e,this):new a(e)}t.__extends=function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},t.__assign=function(){return t.__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.__assign.apply(this,arguments)},t.__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},t.__decorate=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(i<3?o(a):3<i?o(t,r,a):o(t,r))||a);return 3<i&&a&&Object.defineProperty(t,r,a),a},t.__param=function(e,t){return function(r,n){t(r,n,e)}},t.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},t.__awaiter=function(e,t,r,n){return new(r=r||Promise)(function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})},t.__generator=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},t.__exportStar=function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},t.__values=o,t.__read=i,t.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},t.__spreadArrays=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},t.__await=a,t.__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){1<i.push([e,t,r,n])||c(e,t)})})}function c(e,t){try{!function(e){e.value instanceof a?Promise.resolve(e.value.v).then(u,l):h(i[0][2],e)}(o[e](t))}catch(e){h(i[0][3],e)}}function u(e){c("next",e)}function l(e){c("throw",e)}function h(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}},t.__asyncDelegator=function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:a(e[n](t)),done:"return"===n}:o?o(t):t}:o}},t.__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=o(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,o,(t=e[r](t)).done,t.value)})}}},t.__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},t.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},t.__importDefault=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(o.isEmpty=function(e){return void 0===e||!e||0===e.length},o);function o(){}t.StringUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(o.createNewGuid=function(){var e=window.crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,o.decimalToHex(t[0])+o.decimalToHex(t[1])+o.decimalToHex(t[2])+o.decimalToHex(t[3])+"-"+o.decimalToHex(t[4])+o.decimalToHex(t[5])+"-"+o.decimalToHex(t[6])+o.decimalToHex(t[7])+"-"+o.decimalToHex(t[8])+o.decimalToHex(t[9])+"-"+o.decimalToHex(t[10])+o.decimalToHex(t[11])+o.decimalToHex(t[12])+o.decimalToHex(t[13])+o.decimalToHex(t[14])+o.decimalToHex(t[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==r[s]&&"4"!==r[s]&&(i=16*Math.random()|0),"x"===r[s]?a+=n[i]:"y"===r[s]?(i&=3,a+=n[i|=8]):a+=r[s];return a},o.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},o.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},o.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},o.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},o.deserialize=function(e){function t(e){return decodeURIComponent(e.replace(n," "))}var r,n=/\+/g,o=/([^&=]+)=([^&]*)/g,i={};for(r=o.exec(e);r;)i[t(r[1])]=t(r[2]),r=o.exec(e);return i},o);function o(){}t.CryptoUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=r(13),i=r(1),a=r(2),s=(c.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},c.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(o.ScopeSet.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},c.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);0<=r&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},c.getDefaultRedirectUri=function(){return window.location.href.split("?")[0].split("#")[0]},c.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),o=r.PathSegments;return!t||0===o.length||o[0]!==n.Constants.common&&o[0]!==n.SSOTypes.ORGANIZATIONS||(o[0]=t),this.constructAuthorityUriFromObject(r,o)},c.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},c.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&0<e.length}),n.PathSegments=o,n},c.CanonicalizeUri=function(e){return(e=e&&e.toLowerCase())&&!c.endsWith(e,"/")&&(e+="/"),e},c.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},c.urlRemoveQueryStringParameter=function(e,t){if(i.StringUtils.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},c.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return-1<r?e.substring(r+2):-1<t?e.substring(t+1):e},c.urlContainsHash=function(e){var t=c.deserializeHash(e);return t.hasOwnProperty(n.ServerHashParamKeys.ERROR_DESCRIPTION)||t.hasOwnProperty(n.ServerHashParamKeys.ERROR)||t.hasOwnProperty(n.ServerHashParamKeys.ACCESS_TOKEN)||t.hasOwnProperty(n.ServerHashParamKeys.ID_TOKEN)},c.deserializeHash=function(e){var t=c.getHashFromUrl(e);return a.CryptoUtils.deserialize(t)},c);function c(){}t.UrlUtils=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o,i,a,s,c,u=(Object.defineProperty(l,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"consumersUtid",{get:function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(l,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(l,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(l,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(l,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),l._popUpWidth=483,l._popUpHeight=600,l);function l(){}t.Constants=u,(n=t.RequestStatus||(t.RequestStatus={})).CANCELLED="Cancelled",n.COMPLETED="Completed",n.IN_PROGRESS="InProgress",(o=t.ServerHashParamKeys||(t.ServerHashParamKeys={})).SCOPE="scope",o.ERROR="error",o.ERROR_DESCRIPTION="error_description",o.ACCESS_TOKEN="access_token",o.ID_TOKEN="id_token",o.EXPIRES_IN="expires_in",o.SESSION_STATE="session_state",o.CLIENT_INFO="client_info",(i=t.TemporaryCacheKeys||(t.TemporaryCacheKeys={})).AUTHORITY="authority",i.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",i.SESSION_STATE="session.state",i.STATE_LOGIN="state.login",i.STATE_ACQ_TOKEN="state.acquireToken",i.STATE_RENEW="state.renew",i.NONCE_IDTOKEN="nonce.idtoken",i.LOGIN_REQUEST="login.request",i.RENEW_STATUS="token.renew.status",i.URL_HASH="urlHash",i.ANGULAR_LOGIN_REQUEST="angular.login.request",i.INTERACTION_STATUS="interaction.status",(a=t.PersistentCacheKeys||(t.PersistentCacheKeys={})).IDTOKEN="idtoken",a.CLIENT_INFO="client.info",a.ADAL_ID_TOKEN="adal.idtoken",a.ERROR="error",a.ERROR_DESC="error.description",a.LOGIN_ERROR="login.error",t.AADTrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},(c=s=t.SSOTypes||(t.SSOTypes={})).ACCOUNT="account",c.SID="sid",c.LOGIN_HINT="login_hint",c.ID_TOKEN="id_token",c.DOMAIN_HINT="domain_hint",c.ORGANIZATIONS="organizations",c.CONSUMERS="consumers",c.ACCOUNT_ID="accountIdentifier",c.HOMEACCOUNT_ID="homeAccountIdentifier",c.LOGIN_REQ="login_req",c.DOMAIN_REQ="domain_req",t.BlacklistedEQParams=[s.SID,s.LOGIN_HINT],t.PromptState={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},t.libraryVersion=function(){return"1.2.0-beta.4"}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(6);t.ClientConfigurationErrorMessage={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"}};var i,a=(i=o.ClientAuthError,n.__extends(s,i),s.createNoSetConfigurationError=function(){return new s(t.ClientConfigurationErrorMessage.configurationNotSet.code,""+t.ClientConfigurationErrorMessage.configurationNotSet.desc)},s.createStorageNotSupportedError=function(e){return new s(t.ClientConfigurationErrorMessage.storageNotSupported.code,t.ClientConfigurationErrorMessage.storageNotSupported.desc+" Given location: "+e)},s.createRedirectCallbacksNotSetError=function(){return new s(t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.code,t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc)},s.createInvalidCallbackObjectError=function(e){return new s(t.ClientConfigurationErrorMessage.invalidCallbackObject.code,t.ClientConfigurationErrorMessage.invalidCallbackObject.desc+" Given value for callback function: "+e)},s.createEmptyScopesArrayError=function(e){return new s(t.ClientConfigurationErrorMessage.emptyScopes.code,t.ClientConfigurationErrorMessage.emptyScopes.desc+" Given value: "+e+".")},s.createScopesNonArrayError=function(e){return new s(t.ClientConfigurationErrorMessage.nonArrayScopes.code,t.ClientConfigurationErrorMessage.nonArrayScopes.desc+" Given value: "+e+".")},s.createClientIdSingleScopeError=function(e){return new s(t.ClientConfigurationErrorMessage.clientScope.code,t.ClientConfigurationErrorMessage.clientScope.desc+" Given value: "+e+".")},s.createScopesRequiredError=function(e){return new s(t.ClientConfigurationErrorMessage.scopesRequired.code,t.ClientConfigurationErrorMessage.scopesRequired.desc+" Given value: "+e)},s.createInvalidPromptError=function(e){return new s(t.ClientConfigurationErrorMessage.invalidPrompt.code,t.ClientConfigurationErrorMessage.invalidPrompt.desc+" Given value: "+e)},s.createClaimsRequestParsingError=function(e){return new s(t.ClientConfigurationErrorMessage.claimsRequestParsingError.code,t.ClientConfigurationErrorMessage.claimsRequestParsingError.desc+" Given value: "+e)},s.createEmptyRequestError=function(){var e=t.ClientConfigurationErrorMessage.emptyRequestError;return new s(e.code,e.desc)},s.createInvalidCorrelationIdError=function(){return new s(t.ClientConfigurationErrorMessage.invalidCorrelationIdError.code,t.ClientConfigurationErrorMessage.invalidCorrelationIdError.desc)},s.createTelemetryConfigError=function(e){var r=t.ClientConfigurationErrorMessage.telemetryConfigError,n=r.code,o=r.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new s(n,o+" mising values: "+Object.keys(i).reduce(function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"])},[]).join(","))},s);function s(e,t){var r=i.call(this,e,t)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,s.prototype),r}t.ClientConfigurationError=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(1);t.ClientAuthErrorMessage={multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required."},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"}};var a,s=(a=o.AuthError,n.__extends(c,a),c.createEndpointResolutionError=function(e){var r=t.ClientAuthErrorMessage.endpointResolutionError.desc;return e&&!i.StringUtils.isEmpty(e)&&(r+=" Details: "+e),new c(t.ClientAuthErrorMessage.endpointResolutionError.code,r)},c.createMultipleMatchingTokensInCacheError=function(e){return new c(t.ClientAuthErrorMessage.multipleMatchingTokens.code,"Cache error for scope "+e+": "+t.ClientAuthErrorMessage.multipleMatchingTokens.desc+".")},c.createMultipleAuthoritiesInCacheError=function(e){return new c(t.ClientAuthErrorMessage.multipleCacheAuthorities.code,"Cache error for scope "+e+": "+t.ClientAuthErrorMessage.multipleCacheAuthorities.desc+".")},c.createPopupWindowError=function(e){var r=t.ClientAuthErrorMessage.popUpWindowError.desc;return e&&!i.StringUtils.isEmpty(e)&&(r+=" Details: "+e),new c(t.ClientAuthErrorMessage.popUpWindowError.code,r)},c.createTokenRenewalTimeoutError=function(e){var r="URL navigated to is "+e+", "+t.ClientAuthErrorMessage.tokenRenewalError.desc;return new c(t.ClientAuthErrorMessage.tokenRenewalError.code,r)},c.createInvalidIdTokenError=function(e){return new c(t.ClientAuthErrorMessage.invalidIdToken.code,t.ClientAuthErrorMessage.invalidIdToken.desc+" Given token: "+e)},c.createInvalidStateError=function(e,r){return new c(t.ClientAuthErrorMessage.invalidStateError.code,t.ClientAuthErrorMessage.invalidStateError.desc+" "+e+", state expected : "+r+".")},c.createNonceMismatchError=function(e,r){return new c(t.ClientAuthErrorMessage.nonceMismatchError.code,t.ClientAuthErrorMessage.nonceMismatchError.desc+" "+e+", nonce expected : "+r+".")},c.createLoginInProgressError=function(){return new c(t.ClientAuthErrorMessage.loginProgressError.code,t.ClientAuthErrorMessage.loginProgressError.desc)},c.createAcquireTokenInProgressError=function(){return new c(t.ClientAuthErrorMessage.acquireTokenProgressError.code,t.ClientAuthErrorMessage.acquireTokenProgressError.desc)},c.createUserCancelledError=function(){return new c(t.ClientAuthErrorMessage.userCancelledError.code,t.ClientAuthErrorMessage.userCancelledError.desc)},c.createErrorInCallbackFunction=function(e){return new c(t.ClientAuthErrorMessage.callbackError.code,t.ClientAuthErrorMessage.callbackError.desc+" "+e+".")},c.createUserLoginRequiredError=function(){return new c(t.ClientAuthErrorMessage.userLoginRequiredError.code,t.ClientAuthErrorMessage.userLoginRequiredError.desc)},c.createUserDoesNotExistError=function(){return new c(t.ClientAuthErrorMessage.userDoesNotExistError.code,t.ClientAuthErrorMessage.userDoesNotExistError.desc)},c.createClientInfoDecodingError=function(e){return new c(t.ClientAuthErrorMessage.clientInfoDecodingError.code,t.ClientAuthErrorMessage.clientInfoDecodingError.desc+" Failed with error: "+e)},c.createClientInfoNotPopulatedError=function(e){return new c(t.ClientAuthErrorMessage.clientInfoNotPopulatedError.code,t.ClientAuthErrorMessage.clientInfoNotPopulatedError.desc+" Failed with error: "+e)},c.createIdTokenNullOrEmptyError=function(e){return new c(t.ClientAuthErrorMessage.nullOrEmptyIdToken.code,t.ClientAuthErrorMessage.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},c.createIdTokenParsingError=function(e){return new c(t.ClientAuthErrorMessage.idTokenNotParsed.code,t.ClientAuthErrorMessage.idTokenNotParsed.desc+" Failed with error: "+e)},c.createTokenEncodingError=function(e){return new c(t.ClientAuthErrorMessage.tokenEncodingError.code,t.ClientAuthErrorMessage.tokenEncodingError.desc+" Attempted to decode: "+e)},c.createInvalidInteractionTypeError=function(){return new c(t.ClientAuthErrorMessage.invalidInteractionType.code,t.ClientAuthErrorMessage.invalidInteractionType.desc)},c.createCacheParseError=function(e){var r="invalid key: "+e+", "+t.ClientAuthErrorMessage.cacheParseError.desc;return new c(t.ClientAuthErrorMessage.cacheParseError.code,r)},c);function c(e,t){var r=a.call(this,e,t)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,c.prototype),r}t.ClientAuthError=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.AuthErrorMessage={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},noWindowObjectError:{code:"no_window_object",desc:"No window object available. Details:"}};var o,i=(o=Error,n.__extends(a,o),a.createUnexpectedError=function(e){return new a(t.AuthErrorMessage.unexpectedError.code,t.AuthErrorMessage.unexpectedError.desc+": "+e)},a.createNoWindowObjectError=function(e){return new a(t.AuthErrorMessage.noWindowObjectError.code,t.AuthErrorMessage.noWindowObjectError.desc+" "+e)},a);function a(e,t){var r=o.call(this,t)||this;return Object.setPrototypeOf(r,a.prototype),r.errorCode=e,r.errorMessage=t,r.name="AuthError",r}t.AuthError=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0),i=r(5),a=r(18),s=r(3);(n=t.AuthorityType||(t.AuthorityType={}))[n.Aad=0]="Aad",n[n.Adfs=1]="Adfs",n[n.B2C=2]="B2C";var c=(Object.defineProperty(u.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),u.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(u.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=s.UrlUtils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=s.UrlUtils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),u.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw i.ClientConfigurationErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw i.ClientConfigurationErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw i.ClientConfigurationErrorMessage.authorityUriInvalidPath},u.prototype.DiscoverEndpoints=function(e){return(new a.XhrClient).sendRequestAsync(e,"GET",!0).then(function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}})},u.prototype.resolveEndpointsAsync=function(){return o.__awaiter(this,void 0,Promise,function(){var e,t;return o.__generator(this,function(r){switch(r.label){case 0:return[4,this.GetOpenIdConfigurationEndpointAsync()];case 1:return e=r.sent(),[4,(t=this).DiscoverEndpoints(e)];case 2:return t.tenantDiscoveryResponse=r.sent(),[2,this]}})})},u);function u(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}t.Authority=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_NAME_PREFIX="msal.",t.EVENT_NAME_KEY="event_name",t.START_TIME_KEY="start_time",t.ELAPSED_TIME_KEY="elapsed_time",t.TELEMETRY_BLOB_EVENT_NAMES={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},t.TENANT_PLACEHOLDER="<tenant>"},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o,i=r(1),a=r(4);(o=n=t.LogLevel||(t.LogLevel={}))[o.Error=0]="Error",o[o.Warning=1]="Warning",o[o.Info=2]="Info",o[o.Verbose=3]="Verbose";var s=(c.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var o,s=(new Date).toUTCString();o=i.StringUtils.isEmpty(this.correlationId)?s+":"+a.libraryVersion()+"-"+n[e]+" "+t:s+":"+this.correlationId+"-"+a.libraryVersion()+"-"+n[e]+" "+t,this.executeCallback(e,o,r)}},c.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},c.prototype.error=function(e){this.logMessage(n.Error,e,!1)},c.prototype.errorPii=function(e){this.logMessage(n.Error,e,!0)},c.prototype.warning=function(e){this.logMessage(n.Warning,e,!1)},c.prototype.warningPii=function(e){this.logMessage(n.Warning,e,!0)},c.prototype.info=function(e){this.logMessage(n.Info,e,!1)},c.prototype.infoPii=function(e){this.logMessage(n.Info,e,!0)},c.prototype.verbose=function(e){this.logMessage(n.Verbose,e,!1)},c.prototype.verbosePii=function(e){this.logMessage(n.Verbose,e,!0)},c.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},c);function c(e,t){void 0===t&&(t={}),this.level=n.Info;var r=t.correlationId,o=void 0===r?"":r,i=t.level,a=void 0===i?n.Info:i,s=t.piiLoggingEnabled,c=void 0!==s&&s;this.localCallback=e,this.correlationId=o,this.level=a,this.piiLoggingEnabled=c}t.Logger=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7);t.ServerErrorMessage={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}};var i,a=(i=o.AuthError,n.__extends(s,i),s.createServerUnavailableError=function(){return new s(t.ServerErrorMessage.serverUnavailable.code,t.ServerErrorMessage.serverUnavailable.desc)},s.createUnknownServerError=function(e){return new s(t.ServerErrorMessage.unknownServerError.code,e)},s);function s(e,t){var r=i.call(this,e,t)||this;return r.name="ServerError",Object.setPrototypeOf(r,s.prototype),r}t.ServerError=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(26),i=r(27),a=r(28),s=r(29),c=r(4),u=r(30),l=r(31),h=r(16),d=r(13),p=r(1),f=r(34),g=r(15),y=r(35),m=r(3),E=r(36),C=r(37),v=r(20),I=r(5),S=r(7),T=r(6),_=r(11),w=r(21),A=r(22),O=n.__importDefault(r(38)),b="id_token",P="token",R="id_token token",k=(Object.defineProperty(N.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=C.AuthorityFactory.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),N.prototype.getAuthorityInstance=function(){return this.authorityInstance},N.prototype.handleRedirectCallback=function(e,t){if(!e)throw this.redirectCallbacksSet=!1,I.ClientConfigurationError.createInvalidCallbackObjectError(e);if(t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectCallbacksSet=!0,!this.config.framework.isAngular){var r=this.cacheStorage.getItem(c.TemporaryCacheKeys.URL_HASH);r&&this.processCallBack(r,null)}},N.prototype.authResponseHandler=function(e,t,r){if(e===c.Constants.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==c.Constants.interactionTypePopup)throw T.ClientAuthError.createInvalidInteractionTypeError();r(t)}},N.prototype.authErrorHandler=function(e,t,r,n){if(e===c.Constants.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,r.accountState):this.authResponseCallback(t,r);else{if(e!==c.Constants.interactionTypePopup)throw T.ClientAuthError.createInvalidInteractionTypeError();n(t)}},N.prototype.loginRedirect=function(e){if(!this.redirectCallbacksSet)throw I.ClientConfigurationError.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(c.Constants.interactionTypeRedirect,!0,e)},N.prototype.acquireTokenRedirect=function(e){if(!e)throw I.ClientConfigurationError.createEmptyRequestError();if(!this.redirectCallbacksSet)throw I.ClientConfigurationError.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(c.Constants.interactionTypeRedirect,!1,e)},N.prototype.loginPopup=function(e){var t=this;return new Promise(function(r,n){t.acquireTokenInteractive(c.Constants.interactionTypePopup,!0,e,r,n)})},N.prototype.acquireTokenPopup=function(e){var t=this;if(!e)throw I.ClientConfigurationError.createEmptyRequestError();return new Promise(function(r,n){t.acquireTokenInteractive(c.Constants.interactionTypePopup,!1,e,r,n)})},N.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i=this;if(this.cacheStorage.getItem(c.TemporaryCacheKeys.INTERACTION_STATUS)!==c.RequestStatus.IN_PROGRESS){var s=t?this.appendScopes(r):r.scopes;this.validateInputScope(s,!t);var u=r&&r.account&&!t?r.account:this.getAccount();if(u||a.ServerRequestParameters.isSSOParam(r))this.acquireTokenHelper(u,e,t,r,s,n,o);else{if(!t)throw this.logger.info("User login is required"),T.ClientAuthError.createUserLoginRequiredError();if(this.extractADALIdToken()&&!s){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken ");var l=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(l).then(function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,n)},function(a){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+a),i.acquireTokenHelper(null,e,t,r,s,n,o)})}else this.acquireTokenHelper(null,e,t,r,s,n,o)}}else{var h=t?T.ClientAuthError.createLoginInProgressError():T.ClientAuthError.createAcquireTokenInProgressError(),d=A.buildResponseStateOnly(this.getAccountState(r&&r.state));this.authErrorHandler(e,h,d,o)}},N.prototype.acquireTokenHelper=function(e,t,r,o,i,s,u){var l=this;this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.IN_PROGRESS);var h,d,p=i?i.join(" ").toLowerCase():this.clientId.toLowerCase(),g=o&&o.authority?C.AuthorityFactory.CreateInstance(o.authority,this.config.auth.validateAuthority):this.authorityInstance;if(t===c.Constants.interactionTypePopup){try{d=this.openPopup("about:blank","msal",c.Constants.popUpWidth,c.Constants.popUpHeight),f.WindowUtils.trackPopup(d)}catch(e){this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.CANCELLED),this.logger.info(T.ClientAuthErrorMessage.popUpWindowError.code+":"+T.ClientAuthErrorMessage.popUpWindowError.desc),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR,T.ClientAuthErrorMessage.popUpWindowError.code),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR_DESC,T.ClientAuthErrorMessage.popUpWindowError.desc),u&&u(T.ClientAuthError.createPopupWindowError())}if(!d)return}g.resolveEndpointsAsync().then(function(){return n.__awaiter(l,void 0,void 0,function(){var l,y,E,C,v;return n.__generator(this,function(n){switch(n.label){case 0:if(l=r?b:this.getTokenType(e,i,!1),r&&((y=this.cacheStorage.getItem(c.TemporaryCacheKeys.ANGULAR_LOGIN_REQUEST))&&""!==y?this.cacheStorage.setItem(c.TemporaryCacheKeys.ANGULAR_LOGIN_REQUEST,""):y=window.location.href),h=new a.ServerRequestParameters(g,this.clientId,l,this.getRedirectUri(o&&o.redirectUri),i,o&&o.state,o&&o.correlationId),this.updateCacheEntries(h,e,y),h.populateQueryParams(e,o),E=m.UrlUtils.createNavigateUrl(h)+c.Constants.response_mode_fragment,t===c.Constants.interactionTypeRedirect)r||this.cacheStorage.setItem(c.TemporaryCacheKeys.STATE_ACQ_TOKEN,h.state,this.inCookie);else{if(t!==c.Constants.interactionTypePopup)throw T.ClientAuthError.createInvalidInteractionTypeError();window.renewStates.push(h.state),window.requestType=r?c.Constants.login:c.Constants.renewToken,this.registerCallback(h.state,p,s,u)}if(this.navigateWindow(E,d),!d)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,f.WindowUtils.monitorWindowForHash(d,this.config.system.loadFrameTimeout,E)];case 2:return C=n.sent(),this.handleAuthenticationResponse(C),this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.COMPLETED),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",C),f.WindowUtils.closePopups()),[3,4];case 3:return v=n.sent(),u&&u(v),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",v.errorCode+c.Constants.resourceDelimiter+v.errorMessage):(this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.CANCELLED),d.close()),[3,4];case 4:return[2]}})})}).catch(function(e){l.logger.warning("could not resolve endpoints"),l.authErrorHandler(t,T.ClientAuthError.createEndpointResolutionError(e.toString),A.buildResponseStateOnly(o.state),u),d&&d.close()})},N.prototype.acquireTokenSilent=function(e){var t=this;if(!e)throw I.ClientConfigurationError.createEmptyRequestError();return new Promise(function(r,n){t.validateInputScope(e.scopes,!0);var o=e.scopes.join(" ").toLowerCase(),i=e.account||t.getAccount(),s=t.cacheStorage.getItem(c.Constants.adalIdToken);if(!i&&!e.sid&&!e.loginHint&&p.StringUtils.isEmpty(s))return t.logger.info("User login is required"),n(T.ClientAuthError.createUserLoginRequiredError());var u=t.getTokenType(i,e.scopes,!0),l=new a.ServerRequestParameters(C.AuthorityFactory.CreateInstance(e.authority,t.config.auth.validateAuthority),t.clientId,u,t.getRedirectUri(e.redirectUri),e.scopes,e.state,e.correlationId);if(a.ServerRequestParameters.isSSOParam(e)||i)l.populateQueryParams(i,e);else if(!i&&!p.StringUtils.isEmpty(s)){var h=g.TokenUtils.extractIdToken(s);t.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken "),l.populateQueryParams(i,null,h)}var d,f,y=e.claimsRequest||l.claimsValue;if(!y&&!e.forceRefresh)try{f=t.getCachedToken(l,i)}catch(r){d=r}if(f)return t.logger.info("Token is already in cache for scope:"+o),r(f),null;if(d)return t.logger.infoPii(d.errorCode+":"+d.errorMessage),n(d),null;var m=void 0;return m=y?"Skipped cache lookup since claims were given.":e.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope:"+o,t.logger.verbose(m),l.authorityInstance||(l.authorityInstance=e.authority?C.AuthorityFactory.CreateInstance(e.authority,t.config.auth.validateAuthority):t.authorityInstance),l.authorityInstance.resolveEndpointsAsync().then(function(){window.activeRenewals[o]?(t.logger.verbose("Renew token for scope: "+o+" is in progress. Registering callback"),t.registerCallback(window.activeRenewals[o],o,r,n)):e.scopes&&-1<e.scopes.indexOf(t.clientId)&&1===e.scopes.length?(t.logger.verbose("renewing idToken"),t.silentLogin=!0,t.renewIdToken(e.scopes,r,n,i,l)):(t.logger.verbose("renewing accesstoken"),t.renewToken(e.scopes,r,n,i,l))}).catch(function(e){return t.logger.warning("could not resolve endpoints"),n(T.ClientAuthError.createEndpointResolutionError(e.toString())),null})})},N.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=a/2-r/2+o,l=s/2-n/2+i,h=window.open(e,t,"width="+r+", height="+n+", top="+l+", left="+u);if(!h)throw T.ClientAuthError.createPopupWindowError();return h.focus&&h.focus(),h}catch(e){throw this.logger.error("error opening popup "+e.message),this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.CANCELLED),T.ClientAuthError.createPopupWindowError(e.toString())}},N.prototype.loadIframeTimeout=function(e,t,r){return n.__awaiter(this,void 0,Promise,function(){var o,i,a,s;return n.__generator(this,function(n){switch(n.label){case 0:return o=window.activeRenewals[r],this.logger.verbose("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem(c.TemporaryCacheKeys.RENEW_STATUS+o,c.RequestStatus.IN_PROGRESS),[4,f.WindowUtils.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)];case 1:i=n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,f.WindowUtils.monitorWindowForHash(i.contentWindow,this.config.system.loadFrameTimeout,e)];case 3:return(a=n.sent())&&this.handleAuthenticationResponse(a),[3,5];case 4:throw s=n.sent(),this.cacheStorage.getItem(c.TemporaryCacheKeys.RENEW_STATUS+o)===c.RequestStatus.IN_PROGRESS&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,s),this.cacheStorage.setItem(c.TemporaryCacheKeys.RENEW_STATUS+o,c.RequestStatus.CANCELLED)),f.WindowUtils.removeHiddenIframe(i),s;case 5:return f.WindowUtils.removeHiddenIframe(i),[2]}})})},N.prototype.navigateWindow=function(e,t){if(!e||p.StringUtils.isEmpty(e))throw this.logger.info("Navigate url is empty"),S.AuthError.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},N.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw S.AuthError.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(r){o.logger.warning(r)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},N.prototype.logout=function(){var e=this;this.clearCache(),this.account=null;var t="";this.getPostLogoutRedirectUri()&&(t="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri())),this.authorityInstance.resolveEndpointsAsync().then(function(r){var n=r.EndSessionEndpoint?r.EndSessionEndpoint+"?"+t:e.authority+"oauth2/v2.0/logout?"+t;e.navigateWindow(n)})},N.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie()},N.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key))}},N.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),m.UrlUtils.urlContainsHash(e)},N.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("Processing the callback from redirect response"),t=t||this.getResponseState(e);try{n=this.saveTokenFromHash(e,t)}catch(e){o=e}this.cacheStorage.removeItem(c.TemporaryCacheKeys.URL_HASH);try{this.cacheStorage.clearMsalCookie(t.state);var i=this.getAccountState(t.state);if(n){if(t.requestType===c.Constants.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),n.tokenType=c.ServerHashParamKeys.ACCESS_TOKEN):t.requestType===c.Constants.login&&(n.tokenType=c.ServerHashParamKeys.ID_TOKEN),!r)return void this.authResponseHandler(c.Constants.interactionTypeRedirect,n)}else if(!r)return void this.authErrorHandler(c.Constants.interactionTypeRedirect,o,A.buildResponseStateOnly(i));r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),T.ClientAuthError.createErrorInCallbackFunction(e.toString())}},N.prototype.handleAuthenticationResponse=function(e){var t=e||window.location.hash,r=f.WindowUtils.getIframeWithHash(t),n=f.WindowUtils.getPopUpWithHash(t),o=!(!r&&!n),i=this.getResponseState(t),a=null;if(this.logger.info("Returned from redirect url"),o)a=window.callbackMappedToRenewStates[i.state];else{if(a=null,this.config.auth.navigateToLoginRequestUrl){if(this.cacheStorage.setItem(c.TemporaryCacheKeys.URL_HASH,t),window.parent===window){var s=this.cacheStorage.getItem(c.TemporaryCacheKeys.LOGIN_REQUEST,this.inCookie);s&&"null"!==s?window.location.href=s:(this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),window.location.href="/")}return}if(window.location.hash="",!this.redirectCallbacksSet)return void this.cacheStorage.setItem(c.TemporaryCacheKeys.URL_HASH,t)}this.processCallBack(t,i,a),o&&f.WindowUtils.closePopups()},N.prototype.getResponseState=function(e){var t,r=m.UrlUtils.deserializeHash(e);if(!r)throw S.AuthError.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty("state"))throw S.AuthError.createUnexpectedError("Hash does not contain state.");if((t={requestType:c.Constants.unknown,state:r.state,stateMatch:!1}).state===this.cacheStorage.getItem(c.TemporaryCacheKeys.STATE_LOGIN,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=c.Constants.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(c.TemporaryCacheKeys.STATE_ACQ_TOKEN,this.inCookie))return t.requestType=c.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var n=window.renewStates,o=0;o<n.length;o++)if(n[o]===t.state){t.stateMatch=!0;break}}return t},N.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(a=0;a<o.length;a++)l=(s=o[a]).key.scopes.split(" "),d.ScopeSet.containsScope(l,n)&&m.UrlUtils.CanonicalizeUri(s.key.authority)===e.authority&&i.push(s);if(0===i.length)return null;if(1!==i.length)throw T.ClientAuthError.createMultipleMatchingTokensInCacheError(n.toString());r=i[0]}else{for(var a=0;a<o.length;a++){var s,l=(s=o[a]).key.scopes.split(" ");d.ScopeSet.containsScope(l,n)&&i.push(s)}if(1===i.length)r=i[0],e.authorityInstance=C.AuthorityFactory.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(1<i.length)throw T.ClientAuthError.createMultipleMatchingTokensInCacheError(n.toString());var h=this.getUniqueAuthority(o,"authority");if(1<h.length)throw T.ClientAuthError.createMultipleAuthoritiesInCacheError(n.toString());e.authorityInstance=C.AuthorityFactory.CreateInstance(h[0],this.config.auth.validateAuthority)}}if(null==r)return null;var p=Number(r.value.expiresIn),f=this.config.system.tokenRenewalOffsetSeconds||300;if(p&&p>y.TimeUtils.now()+f){var g=new u.IdToken(r.value.idToken);if(!t&&!(t=this.getAccount()))throw S.AuthError.createUnexpectedError("Account should not be null here.");var v=this.getAccountState(e.state),I={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?c.ServerHashParamKeys.ID_TOKEN:c.ServerHashParamKeys.ACCESS_TOKEN,idToken:g,idTokenClaims:g.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*p),account:t,accountState:v,fromCache:!0};return E.ResponseUtils.setResponseIdToken(I,g),I}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null},N.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))}),r},N.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(c.Constants.adalIdToken);return p.StringUtils.isEmpty(e)?null:g.TokenUtils.extractIdToken(e)},N.prototype.renewToken=function(e,t,r,n,o){var i=e.join(" ").toLowerCase();this.logger.verbose("renewToken is called for scope:"+i);var a="msalRenewFrame"+i,s=f.WindowUtils.addHiddenIFrame(a,this.logger);this.updateCacheEntries(o,n),this.logger.verbose("Renew token Expected state: "+o.state);var u=m.UrlUtils.urlRemoveQueryStringParameter(m.UrlUtils.createNavigateUrl(o),c.Constants.prompt)+c.Constants.prompt_none+c.Constants.response_mode_fragment;window.renewStates.push(o.state),window.requestType=c.Constants.renewToken,this.registerCallback(o.state,i,t,r),this.logger.infoPii("Navigate to:"+u),s.src="about:blank",this.loadIframeTimeout(u,a,i).catch(function(e){return r(e)})},N.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i="msalIdTokenFrame",a=f.WindowUtils.addHiddenIFrame(i,this.logger);this.updateCacheEntries(o,n),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var s=m.UrlUtils.urlRemoveQueryStringParameter(m.UrlUtils.createNavigateUrl(o),c.Constants.prompt)+c.Constants.prompt_none+c.Constants.response_mode_fragment;this.silentLogin?(window.requestType=c.Constants.login,this.silentAuthenticationState=o.state):(window.requestType=c.Constants.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,this.clientId,t,r),this.logger.infoPii("Navigate to:"+s),a.src="about:blank",this.loadIframeTimeout(s,i,this.clientId).catch(function(e){return r(e)})},N.prototype.saveAccessToken=function(e,t,r,a,u){var l,h,p=n.__assign({},e),f=new s.ClientInfo(a);if(r.hasOwnProperty(c.ServerHashParamKeys.SCOPE)){for(var g=(l=r[c.ServerHashParamKeys.SCOPE]).split(" "),m=this.cacheStorage.getAllAccessTokens(this.clientId,t),E=0;E<m.length;E++){var C=m[E];if(C.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var v=C.key.scopes.split(" ");d.ScopeSet.isIntersectingScopes(v,g)&&this.cacheStorage.removeItem(JSON.stringify(C.key))}}var I=y.TimeUtils.parseExpiresIn(r[c.ServerHashParamKeys.EXPIRES_IN]);h=y.TimeUtils.now()+I;var S=new o.AccessTokenKey(t,this.clientId,l,f.uid,f.utid),T=new i.AccessTokenValue(r[c.ServerHashParamKeys.ACCESS_TOKEN],u.rawIdToken,h.toString(),a);this.cacheStorage.setItem(JSON.stringify(S),JSON.stringify(T)),p.accessToken=r[c.ServerHashParamKeys.ACCESS_TOKEN],p.scopes=g}else l=this.clientId,S=new o.AccessTokenKey(t,this.clientId,l,f.uid,f.utid),h=Number(u.expiration),T=new i.AccessTokenValue(r[c.ServerHashParamKeys.ID_TOKEN],r[c.ServerHashParamKeys.ID_TOKEN],h.toString(),a),this.cacheStorage.setItem(JSON.stringify(S),JSON.stringify(T)),p.scopes=[l],p.accessToken=r[c.ServerHashParamKeys.ID_TOKEN];return h?p.expiresOn=new Date(1e3*h):this.logger.error("Could not parse expiresIn parameter"),p},N.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=m.UrlUtils.deserializeHash(e),i="",a="",d=null;if(o.hasOwnProperty(c.ServerHashParamKeys.ERROR_DESCRIPTION)||o.hasOwnProperty(c.ServerHashParamKeys.ERROR)){if(this.logger.infoPii("Error :"+o[c.ServerHashParamKeys.ERROR]+"; Error description:"+o[c.ServerHashParamKeys.ERROR_DESCRIPTION]),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR,o[c.ServerHashParamKeys.ERROR]),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR_DESC,o[c.ServerHashParamKeys.ERROR_DESCRIPTION]),t.requestType===c.Constants.login&&(this.cacheStorage.setItem(c.PersistentCacheKeys.LOGIN_ERROR,o[c.ServerHashParamKeys.ERROR_DESCRIPTION]+":"+o[c.ServerHashParamKeys.ERROR]),i=l.AuthCache.generateAuthorityKey(t.state)),t.requestType===c.Constants.renewToken){i=l.AuthCache.generateAuthorityKey(t.state);var f=this.getAccount(),g=void 0;g=f&&!p.StringUtils.isEmpty(f.homeAccountIdentifier)?f.homeAccountIdentifier:c.Constants.no_account,a=l.AuthCache.generateAcquireTokenAccountKey(g,t.state)}var y=o[c.ServerHashParamKeys.ERROR],C=o[c.ServerHashParamKeys.ERROR_DESCRIPTION];r=w.InteractionRequiredAuthError.isInteractionRequiredError(y)||w.InteractionRequiredAuthError.isInteractionRequiredError(C)?new w.InteractionRequiredAuthError(o[c.ServerHashParamKeys.ERROR],o[c.ServerHashParamKeys.ERROR_DESCRIPTION]):new _.ServerError(o[c.ServerHashParamKeys.ERROR],o[c.ServerHashParamKeys.ERROR_DESCRIPTION])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(c.ServerHashParamKeys.SESSION_STATE)&&this.cacheStorage.setItem(c.TemporaryCacheKeys.SESSION_STATE,o[c.ServerHashParamKeys.SESSION_STATE]),n.accountState=this.getAccountState(t.state);var v="";if(o.hasOwnProperty(c.ServerHashParamKeys.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),o.hasOwnProperty(c.ServerHashParamKeys.ID_TOKEN)?(d=new u.IdToken(o[c.ServerHashParamKeys.ID_TOKEN]),n.idToken=d,n.idTokenClaims=d.claims):(d=new u.IdToken(this.cacheStorage.getItem(c.PersistentCacheKeys.IDTOKEN)),n=E.ResponseUtils.setResponseIdToken(n,d));var I=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);if(!o.hasOwnProperty(c.ServerHashParamKeys.CLIENT_INFO))throw this.logger.warning("ClientInfo not received in the response from AAD"),T.ClientAuthError.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");v=o[c.ServerHashParamKeys.CLIENT_INFO],n.account=h.Account.createAccount(d,new s.ClientInfo(v));var A=void 0;A=n.account&&!p.StringUtils.isEmpty(n.account.homeAccountIdentifier)?n.account.homeAccountIdentifier:c.Constants.no_account,a=l.AuthCache.generateAcquireTokenAccountKey(A,t.state);var O=l.AuthCache.generateAcquireTokenAccountKey(c.Constants.no_account,t.state),b=this.cacheStorage.getItem(a),P=void 0;p.StringUtils.isEmpty(b)?p.StringUtils.isEmpty(this.cacheStorage.getItem(O))||(n=this.saveAccessToken(n,I,o,v,d)):(P=JSON.parse(b),n.account&&P&&h.Account.compareAccounts(n.account,P)?(n=this.saveAccessToken(n,I,o,v,d),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}o.hasOwnProperty(c.ServerHashParamKeys.ID_TOKEN)&&(this.logger.info("Fragment has id token"),d=new u.IdToken(o[c.ServerHashParamKeys.ID_TOKEN]),n=E.ResponseUtils.setResponseIdToken(n,d),o.hasOwnProperty(c.ServerHashParamKeys.CLIENT_INFO)?v=o[c.ServerHashParamKeys.CLIENT_INFO]:this.logger.warning("ClientInfo not received in the response from AAD"),I=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d),this.account=h.Account.createAccount(d,new s.ClientInfo(v)),n.account=this.account,d&&d.nonce?d.nonce!==this.cacheStorage.getItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+t.state,this.inCookie)?(this.account=null,this.cacheStorage.setItem(c.PersistentCacheKeys.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+t.state,this.inCookie)+",Actual Nonce: "+d.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+t.state,this.inCookie)+",Actual Nonce: "+d.nonce),r=T.ClientAuthError.createNonceMismatchError(this.cacheStorage.getItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+t.state,this.inCookie),d.nonce)):(this.cacheStorage.setItem(c.PersistentCacheKeys.IDTOKEN,o[c.ServerHashParamKeys.ID_TOKEN]),this.cacheStorage.setItem(c.PersistentCacheKeys.CLIENT_INFO,v),this.saveAccessToken(n,I,o,v,d)):(i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=T.ClientAuthError.createInvalidIdTokenError(d),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR_DESC,r.errorMessage)))}else{i=t.state,a=t.state;var R=this.cacheStorage.getItem(c.TemporaryCacheKeys.STATE_LOGIN,this.inCookie);this.logger.error("State Mismatch.Expected State: "+R+",Actual State: "+t.state),r=T.ClientAuthError.createInvalidStateError(t.state,R),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(c.PersistentCacheKeys.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.COMPLETED),this.cacheStorage.setItem(c.TemporaryCacheKeys.RENEW_STATUS+t.state,c.RequestStatus.COMPLETED),this.cacheStorage.removeAcquireTokenEntries(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.CANCELLED),this.cacheStorage.setItem(c.TemporaryCacheKeys.RENEW_STATUS+t.state,c.RequestStatus.CANCELLED),this.cacheStorage.removeAcquireTokenEntries(t.state),r;if(!n)throw S.AuthError.createUnexpectedError("Response is null");return n},N.prototype.populateAuthority=function(e,t,r,n){var o=l.AuthCache.generateAuthorityKey(e),i=r.getItem(o,t);return p.StringUtils.isEmpty(i)?i:m.UrlUtils.replaceTenantPath(i,n.tenantId)},N.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(c.PersistentCacheKeys.IDTOKEN),t=this.cacheStorage.getItem(c.PersistentCacheKeys.CLIENT_INFO);if(p.StringUtils.isEmpty(e)||p.StringUtils.isEmpty(t))return null;var r=new u.IdToken(e),n=new s.ClientInfo(t);return this.account=h.Account.createAccount(r,n),this.account},N.prototype.getAccountState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return e},N.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=new u.IdToken(t[r].value.idToken),o=new s.ClientInfo(t[r].value.homeAccountIdentifier),i=h.Account.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},N.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},N.prototype.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw I.ClientConfigurationError.createScopesNonArrayError(e);if(e.length<1)throw I.ClientConfigurationError.createEmptyScopesArrayError(e.toString());if(-1<e.indexOf(this.clientId)&&1<e.length)throw I.ClientConfigurationError.createClientIdSingleScopeError(e.toString())}else if(t)throw I.ClientConfigurationError.createScopesRequiredError(e)},N.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},N.prototype.appendScopes=function(e){var t;return e&&e.scopes&&(t=e.extraScopesToConsent?e.scopes.concat(e.extraScopesToConsent):e.scopes),t},N.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},N.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:C.AuthorityFactory.CreateInstance(this.authority,this.config.auth.validateAuthority),s=this.getTokenType(o,e,!0),c=new a.ServerRequestParameters(i,this.clientId,s,this.getRedirectUri(),e,r,n);return this.getCachedToken(c,t)},N.prototype.getScopesForEndpoint=function(e){if(0<this.config.framework.unprotectedResources.length)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(-1<e.indexOf(this.config.framework.unprotectedResources[t]))return null;if(0<this.config.framework.protectedResourceMap.size)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(-1<e.indexOf(o))return this.config.framework.protectedResourceMap.get(o)}return-1<e.indexOf("http://")||-1<e.indexOf("https://")?this.getHostFromUri(e)===this.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},N.prototype.getLoginInProgress=function(){return!!this.cacheStorage.getItem(c.TemporaryCacheKeys.URL_HASH)||this.cacheStorage.getItem(c.TemporaryCacheKeys.INTERACTION_STATUS)===c.RequestStatus.IN_PROGRESS},N.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(c.TemporaryCacheKeys.INTERACTION_STATUS,c.RequestStatus.IN_PROGRESS):this.cacheStorage.removeItem(c.TemporaryCacheKeys.INTERACTION_STATUS)},N.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},N.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(c.TemporaryCacheKeys.INTERACTION_STATUS)===c.RequestStatus.IN_PROGRESS},N.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},N.prototype.getLogger=function(){return this.config.system.logger},N.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},N.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},N.prototype.getCurrentConfiguration=function(){if(!this.config)throw I.ClientConfigurationError.createNoSetConfigurationError();return this.config},N.prototype.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},N.prototype.getTokenType=function(e,t,r){return r?h.Account.compareAccounts(e,this.getAccount())?-1<t.indexOf(this.config.auth.clientId)?b:P:-1<t.indexOf(this.config.auth.clientId)?b:R:h.Account.compareAccounts(e,this.getAccount())?-1<t.indexOf(this.clientId)?b:P:R},N.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):c.Constants.no_account,n=l.AuthCache.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},N.prototype.setAuthorityCache=function(e,t){var r=l.AuthCache.generateAuthorityKey(e);this.cacheStorage.setItem(r,m.UrlUtils.CanonicalizeUri(t),this.inCookie)},N.prototype.updateCacheEntries=function(e,t,r){r?(this.cacheStorage.setItem(c.TemporaryCacheKeys.LOGIN_REQUEST,r,this.inCookie),this.cacheStorage.setItem(c.TemporaryCacheKeys.STATE_LOGIN,e.state,this.inCookie)):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(c.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+e.state,e.nonce,this.inCookie)},N.prototype.getAccountId=function(e){return p.StringUtils.isEmpty(e.homeAccountIdentifier)?c.Constants.no_account:e.homeAccountIdentifier},N.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters}},N.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return null;var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw I.ClientConfigurationError.createTelemetryConfigError(e);var i={platform:{sdk:"msal.js",sdkVersion:c.libraryVersion(),applicationName:r,applicationVersion:n},clientId:t};return new O.default(i,o)},N);function N(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=v.buildConfiguration(e),this.redirectCallbacksSet=!1,this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new l.AuthCache(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,r=m.UrlUtils.urlContainsHash(t);this.config.framework.isAngular||!r||f.WindowUtils.isInIframe()||f.WindowUtils.isInPopup()||this.handleAuthenticationResponse(t)}t.UserAgentApplication=k},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(o.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r].toLowerCase()))return!0;return!1},o.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every(function(t){return 0<=e.indexOf(t.toString().toLowerCase())})},o.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase()})},o.removeElement=function(e,t){return e.filter(function(e){return e!==t})},o.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},o);function o(){}t.ScopeSet=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.validateClaimsRequest=function(e){if(e.claimsRequest)try{JSON.parse(e.claimsRequest)}catch(e){throw n.ClientConfigurationError.createClaimsRequestParsingError(e)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(1),i=(a.decodeJwt=function(e){if(o.StringUtils.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},a.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=n.CryptoUtils.base64Decode(r);return o?JSON.parse(o):null}catch(e){}return null},a);function a(){}t.TokenUtils=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(1),i=(a.createAccount=function(e,t){var r,i=e.objectId||e.subject,s=t?t.uid:"",c=t?t.utid:"";return o.StringUtils.isEmpty(s)||o.StringUtils.isEmpty(c)||(r=n.CryptoUtils.base64Encode(s)+"."+n.CryptoUtils.base64Encode(c)),new a(i,r,e.preferredName,e.name,e.claims,e.sid,e.issuer)},a.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},a);function a(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}t.Account=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0),i=r(8),a=r(18),s=r(4),c=(n=i.Authority,o.__extends(u,n),Object.defineProperty(u.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return u.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"AuthorityType",{get:function(){return i.AuthorityType.Aad},enumerable:!0,configurable:!0}),u.prototype.GetOpenIdConfigurationEndpointAsync=function(){return o.__awaiter(this,void 0,Promise,function(){return o.__generator(this,function(e){return!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.DefaultOpenIdConfigurationEndpoint]:[2,(new a.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return e.tenant_discovery_endpoint})]})})},u.prototype.IsInTrustedHostList=function(e){return s.AADTrustedHostList[e.toLowerCase()]},u.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",u);function u(e,t){return n.call(this,e,t)||this}t.AadAuthority=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(o.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise(function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){var t;(i.status<200||300<=i.status)&&o(n.handleError(i.responseText));try{t=JSON.parse(i.responseText)}catch(e){o(n.handleError(i.responseText))}r(t)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()})},o.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},o);function o(){}t.XhrClient=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0),i=r(17),a=r(8),s=r(5),c=r(3),u=(n=i.AadAuthority,o.__extends(l,n),Object.defineProperty(l.prototype,"AuthorityType",{get:function(){return a.AuthorityType.B2C},enumerable:!0,configurable:!0}),l.prototype.GetOpenIdConfigurationEndpointAsync=function(){return o.__awaiter(this,void 0,Promise,function(){return o.__generator(this,function(e){if(!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort))return[2,this.DefaultOpenIdConfigurationEndpoint];throw s.ClientConfigurationErrorMessage.unsupportedAuthorityValidation})})},l.B2C_PREFIX="tfp",l);function l(e,t){var r=n.call(this,e,t)||this,o=c.UrlUtils.GetUrlComponents(e),i=o.PathSegments;if(i.length<3)throw s.ClientConfigurationErrorMessage.b2cAuthorityUriInvalidPath;return r.CanonicalAuthority="https://"+o.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",r}t.B2cAuthority=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(10),i=r(3),a={clientId:"",authority:null,validateAuthority:!0,redirectUri:function(){return i.UrlUtils.getDefaultRedirectUri()},postLogoutRedirectUri:function(){return i.UrlUtils.getDefaultRedirectUri()},navigateToLoginRequestUrl:!0},s={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},c={logger:new o.Logger(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},u={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};t.buildConfiguration=function(e){var t=e.auth,r=e.cache,o=void 0===r?{}:r,i=e.system,l=void 0===i?{}:i,h=e.framework,d=void 0===h?{}:h;return{auth:n.__assign({},a,t),cache:n.__assign({},s,o),system:n.__assign({},c,l),framework:n.__assign({},u,d)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(11);t.InteractionRequiredAuthErrorMessage={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}};var i,a=(i=o.ServerError,n.__extends(s,i),s.isInteractionRequiredError=function(e){var r=[t.InteractionRequiredAuthErrorMessage.interactionRequired.code,t.InteractionRequiredAuthErrorMessage.consentRequired.code,t.InteractionRequiredAuthErrorMessage.loginRequired.code];return e&&-1<r.indexOf(e)},s.createLoginRequiredAuthError=function(e){return new s(t.InteractionRequiredAuthErrorMessage.loginRequired.code,e)},s.createInteractionRequiredAuthError=function(e){return new s(t.InteractionRequiredAuthErrorMessage.interactionRequired.code,e)},s.createConsentRequiredAuthError=function(e){return new s(t.InteractionRequiredAuthErrorMessage.consentRequired.code,e)},s);function s(e,t){var r=i.call(this,e,t)||this;return r.name="InteractionRequiredAuthError",Object.setPrototypeOf(r,s.prototype),r}t.InteractionRequiredAuthError=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.buildResponseStateOnly=function(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=r(4),i=r(9),a=r(2),s=r(3);t.scrubTenantFromUri=function(e){var t=s.UrlUtils.GetUrlComponents(e);if(!o.AADTrustedHostList[t.HostNameAndPort.toLocaleLowerCase()])return null;var r=t.PathSegments;if(r&&2<=r.length){var a=r[1]===n.B2cAuthority.B2C_PREFIX?2:1;a<r.length&&(r[a]=i.TENANT_PLACEHOLDER)}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},t.hashPersonalIdentifier=function(e){return a.CryptoUtils.base64Encode(e)},t.prependEventNamePrefix=function(e){return""+i.EVENT_NAME_PREFIX+(e||"")}},function(e,t,r){e.exports=r(25)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(12);t.UserAgentApplication=n.UserAgentApplication;var o=r(10);t.Logger=o.Logger;var i=r(10);t.LogLevel=i.LogLevel;var a=r(16);t.Account=a.Account;var s=r(4);t.Constants=s.Constants;var c=r(8);t.Authority=c.Authority;var u=r(12);t.CacheResult=u.CacheResult;var l=r(20);t.CacheLocation=l.CacheLocation,t.Configuration=l.Configuration;var h=r(14);t.AuthenticationParameters=h.AuthenticationParameters;var d=r(22);t.AuthResponse=d.AuthResponse;var p=r(2);t.CryptoUtils=p.CryptoUtils;var f=r(7);t.AuthError=f.AuthError;var g=r(6);t.ClientAuthError=g.ClientAuthError;var y=r(11);t.ServerError=y.ServerError;var m=r(5);t.ClientConfigurationError=m.ClientConfigurationError;var E=r(21);t.InteractionRequiredAuthError=E.InteractionRequiredAuthError},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(3);t.AccessTokenKey=function(e,t,r,i,a){this.authority=o.UrlUtils.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=n.CryptoUtils.base64Encode(i)+"."+n.CryptoUtils.base64Encode(a)}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenValue=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(14),i=r(4),a=r(5),s=r(1),c=(Object.defineProperty(u.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),u.prototype.populateQueryParams=function(e,t,r){var n,i={};t&&(t.prompt&&(this.validatePromptParameter(t.prompt),this.promptValue=t.prompt),t.claimsRequest&&(o.validateClaimsRequest(t),this.claimsValue=t.claimsRequest),u.isSSOParam(t)&&(i=this.constructUnifiedCacheQueryParameter(t,null))),r&&(i=this.constructUnifiedCacheQueryParameter(null,r)),i=this.addHintParameters(e,i),t&&(n=this.sanitizeEQParams(t)),this.queryParameters=u.generateQueryParametersString(i),this.extraQueryParameters=u.generateQueryParametersString(n)},u.prototype.validatePromptParameter=function(e){if([i.PromptState.LOGIN,i.PromptState.SELECT_ACCOUNT,i.PromptState.CONSENT,i.PromptState.NONE].indexOf(e)<0)throw a.ClientConfigurationError.createInvalidPromptError(e)},u.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n,o={};if(e)if(e.account){var a=e.account;a.sid?(r=i.SSOTypes.SID,n=a.sid):a.userName&&(r=i.SSOTypes.LOGIN_HINT,n=a.userName)}else e.sid?(r=i.SSOTypes.SID,n=e.sid):e.loginHint&&(r=i.SSOTypes.LOGIN_HINT,n=e.loginHint);else t&&(n=t.hasOwnProperty(i.Constants.upn)?(r=i.SSOTypes.ID_TOKEN,t.upn):(r=i.SSOTypes.ORGANIZATIONS,null));return o=this.addSSOParameter(r,n),e&&e.account&&e.account.homeAccountIdentifier&&(o=this.addSSOParameter(i.SSOTypes.HOMEACCOUNT_ID,e.account.homeAccountIdentifier,o)),o},u.prototype.addHintParameters=function(e,t){return e&&!t[i.SSOTypes.SID]&&(!t[i.SSOTypes.LOGIN_HINT]&&e.sid&&this.promptValue===i.PromptState.NONE?t=this.addSSOParameter(i.SSOTypes.SID,e.sid,t):t[i.SSOTypes.LOGIN_HINT]||!e.userName||s.StringUtils.isEmpty(e.userName)||(t=this.addSSOParameter(i.SSOTypes.LOGIN_HINT,e.userName,t)),t[i.SSOTypes.DOMAIN_REQ]||t[i.SSOTypes.LOGIN_REQ]||(t=this.addSSOParameter(i.SSOTypes.HOMEACCOUNT_ID,e.homeAccountIdentifier,t))),t},u.prototype.addSSOParameter=function(e,t,r){if(r=r||{},!t)return r;switch(e){case i.SSOTypes.SID:r[i.SSOTypes.SID]=t;break;case i.SSOTypes.ID_TOKEN:r[i.SSOTypes.LOGIN_HINT]=t,r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.ORGANIZATIONS;break;case i.SSOTypes.LOGIN_HINT:r[i.SSOTypes.LOGIN_HINT]=t;break;case i.SSOTypes.ORGANIZATIONS:r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.ORGANIZATIONS;break;case i.SSOTypes.CONSUMERS:r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.CONSUMERS;break;case i.SSOTypes.HOMEACCOUNT_ID:var o=t.split("."),a=n.CryptoUtils.base64Decode(o[0]),s=n.CryptoUtils.base64Decode(o[1]);r[i.SSOTypes.LOGIN_REQ]=a,(r[i.SSOTypes.DOMAIN_REQ]=s)===i.Constants.consumersUtid?r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.CONSUMERS:r[i.SSOTypes.DOMAIN_HINT]=i.SSOTypes.ORGANIZATIONS;break;case i.SSOTypes.LOGIN_REQ:r[i.SSOTypes.LOGIN_REQ]=t;break;case i.SSOTypes.DOMAIN_REQ:r[i.SSOTypes.DOMAIN_REQ]=t}return r},u.prototype.sanitizeEQParams=function(e){var t=e.extraQueryParameters;return t?(e.claimsRequest&&delete t[i.Constants.claims],i.BlacklistedEQParams.forEach(function(e){t[e]&&delete t[e]}),t):null},u.generateQueryParametersString=function(e){var t=null;return e&&Object.keys(e).forEach(function(r){null==t?t=r+"="+encodeURIComponent(e[r]):t+="&"+r+"="+encodeURIComponent(e[r])}),t},u.prototype.setRequestServerParams=function(e,t,r,o){if(this.scopes=e?e.slice():[o],this.state=t&&!s.StringUtils.isEmpty(t)?n.CryptoUtils.createNewGuid()+"|"+t:n.CryptoUtils.createNewGuid(),r&&!n.CryptoUtils.isGuid(r))throw a.ClientConfigurationError.createInvalidCorrelationIdError();this.correlationId=r&&n.CryptoUtils.isGuid(r)?r:n.CryptoUtils.createNewGuid()},u.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},u);function u(e,t,r,o,a,s,c){this.authorityInstance=e,this.clientId=t,this.nonce=n.CryptoUtils.createNewGuid(),this.setRequestServerParams(a,s,c,this.clientId),this.xClientSku="MSAL.JS",this.xClientVer=i.libraryVersion(),this.responseType=r,this.redirectUri=o}t.ServerRequestParameters=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(6),i=r(1),a=(Object.defineProperty(s.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),s);function s(e){if(!e||i.StringUtils.isEmpty(e))return this.uid="",void(this.utid="");try{var t=n.CryptoUtils.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw o.ClientAuthError.createClientInfoDecodingError(e)}}t.ClientInfo=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(15),i=r(1);t.IdToken=function(e){if(i.StringUtils.isEmpty(e))throw n.ClientAuthError.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=o.TokenUtils.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw n.ClientAuthError.createIdTokenParsingError(e)}}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0),i=r(4),a=r(32),s=r(33),c=r(6),u=(n=s.BrowserStorage,o.__extends(l,n),l.prototype.migrateCacheEntries=function(e){var t=this,r=i.Constants.cachePrefix+"."+i.PersistentCacheKeys.IDTOKEN,o=i.Constants.cachePrefix+"."+i.PersistentCacheKeys.CLIENT_INFO,a=i.Constants.cachePrefix+"."+i.PersistentCacheKeys.ERROR,s=i.Constants.cachePrefix+"."+i.PersistentCacheKeys.ERROR_DESC,c=[n.prototype.getItem.call(this,r),n.prototype.getItem.call(this,o),n.prototype.getItem.call(this,a),n.prototype.getItem.call(this,s)];[i.PersistentCacheKeys.IDTOKEN,i.PersistentCacheKeys.CLIENT_INFO,i.PersistentCacheKeys.ERROR,i.PersistentCacheKeys.ERROR_DESC].forEach(function(r,n){return t.duplicateCacheEntry(r,c[n],e)})},l.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},l.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+i.Constants.cachePrefix)||0===e.indexOf(i.PersistentCacheKeys.ADAL_ID_TOKEN)?e:t?i.Constants.cachePrefix+"."+this.clientId+"."+e:i.Constants.cachePrefix+"."+e}},l.prototype.setItem=function(e,t,r){n.prototype.setItem.call(this,this.generateCacheKey(e,!0),t,r),this.rollbackEnabled&&n.prototype.setItem.call(this,this.generateCacheKey(e,!1),t,r)},l.prototype.getItem=function(e,t){return n.prototype.getItem.call(this,this.generateCacheKey(e,!0),t)},l.prototype.removeItem=function(e){n.prototype.removeItem.call(this,this.generateCacheKey(e,!0)),this.rollbackEnabled&&n.prototype.removeItem.call(this,this.generateCacheKey(e,!1))},l.prototype.resetCacheItems=function(){var e,t=window[this.cacheLocation];for(e in t)t.hasOwnProperty(e)&&-1!==e.indexOf(i.Constants.cachePrefix)&&n.prototype.removeItem.call(this,e)},l.prototype.setItemCookie=function(e,t,r){n.prototype.setItemCookie.call(this,this.generateCacheKey(e,!0),t,r),this.rollbackEnabled&&n.prototype.setItemCookie.call(this,this.generateCacheKey(e,!1),t,r)},l.prototype.getItemCookie=function(e){return n.prototype.getItemCookie.call(this,this.generateCacheKey(e,!0))},l.prototype.getAllAccessTokens=function(e,t){var r=this;return Object.keys(window[this.cacheLocation]).reduce(function(n,o){if(o.match(e)&&o.match(t)&&o.match(i.Constants.scopes)){var s=r.getItem(o);if(s)try{var u=JSON.parse(o),l=new a.AccessTokenCacheItem(u,JSON.parse(s));return n.concat([l])}catch(n){throw c.ClientAuthError.createCacheParseError(o)}}return n},[])},l.prototype.removeAcquireTokenEntries=function(e){var t,r=window[this.cacheLocation];for(t in r)if(r.hasOwnProperty(t)&&!(-1===t.indexOf(i.TemporaryCacheKeys.AUTHORITY)&&1===t.indexOf(i.TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT)||e&&-1===t.indexOf(e))){var n=t.split(i.Constants.resourceDelimiter),o=void 0;1<n.length&&(o=n[n.length-1]),o!==e||this.tokenRenewalInProgress(o)||(this.removeItem(t),this.removeItem(i.TemporaryCacheKeys.RENEW_STATUS+e),this.removeItem(i.TemporaryCacheKeys.STATE_LOGIN),this.removeItem(i.TemporaryCacheKeys.STATE_ACQ_TOKEN),this.removeItem(i.TemporaryCacheKeys.LOGIN_REQUEST),this.removeItem(i.TemporaryCacheKeys.INTERACTION_STATUS),this.removeItem(i.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+e),this.setItemCookie(t,"",-1),this.clearMsalCookie(e))}},l.prototype.tokenRenewalInProgress=function(e){var t=this.getItem(i.TemporaryCacheKeys.RENEW_STATUS+e);return!(!t||t!==i.RequestStatus.IN_PROGRESS)},l.prototype.clearMsalCookie=function(e){var t=e?i.TemporaryCacheKeys.NONCE_IDTOKEN+"|"+e:i.TemporaryCacheKeys.NONCE_IDTOKEN;this.clearItemCookie(t),this.clearItemCookie(i.TemporaryCacheKeys.STATE_LOGIN),this.clearItemCookie(i.TemporaryCacheKeys.LOGIN_REQUEST),this.clearItemCookie(i.TemporaryCacheKeys.STATE_ACQ_TOKEN)},l.generateAcquireTokenAccountKey=function(e,t){return""+i.TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT+i.Constants.resourceDelimiter+e+i.Constants.resourceDelimiter+t},l.generateAuthorityKey=function(e){return""+i.TemporaryCacheKeys.AUTHORITY+i.Constants.resourceDelimiter+e},l);function l(e,t,r){var o=n.call(this,t)||this;return o.clientId=e,o.rollbackEnabled=!0,o.migrateCacheEntries(r),o}t.AuthCache=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenCacheItem=function(e,t){this.key=e,this.value=t}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(7),i=(a.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},a.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},a.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},a.prototype.clear=function(){return window[this.cacheLocation].clear()},a.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},a.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},a.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},a.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},a);function a(e){if(!window)throw o.AuthError.createNoWindowObjectError("Browser storage class could not find window object");if(void 0===window[e]||null==window[e])throw n.ClientConfigurationError.createStorageNotSupportedError(e);this.cacheLocation=e}t.BrowserStorage=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(3),i=(a.isInIframe=function(){return window.parent!==window},a.isInPopup=function(){return!(!window.opener||window.opener===window)},a.monitorWindowForHash=function(e,t,r){return new Promise(function(i,s){var c=t/a.POLLING_INTERVAL_MS,u=0,l=setInterval(function(){if(e.closed)return clearInterval(l),void s(n.ClientAuthError.createUserCancelledError());var t;try{t=e.location.href}catch(t){}t&&"about:blank"!==t&&(u++,o.UrlUtils.urlContainsHash(t)?(clearInterval(l),i(e.location.hash)):c<u&&(clearInterval(l),s(n.ClientAuthError.createTokenRenewalTimeoutError(r))))},a.POLLING_INTERVAL_MS)})},a.loadFrame=function(e,t,r,n){return n.info("LoadFrame: "+t),new Promise(function(o,i){setTimeout(function(){var r=a.addHiddenIFrame(t,n);r?(""!==r.src&&"about:blank"!==r.src||(r.src=e,n.infoPii("Frame Name : "+t+" Navigated to: "+e)),o(r)):i("Unable to load iframe with name: "+t)},r)})},a.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.info("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},a.removeHiddenIframe=function(e){document.body!==e.parentNode&&document.body.removeChild(e)},a.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,r){return t.item(r)}).filter(function(t){try{return t.contentWindow.location.hash===e}catch(t){return!1}})[0]},a.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},a.getPopUpWithHash=function(e){return a.getPopups().filter(function(t){try{return t.location.hash===e}catch(t){return!1}})[0]},a.trackPopup=function(e){a.getPopups().push(e)},a.closePopups=function(){a.getPopups().forEach(function(e){return e.close()})},a.POLLING_INTERVAL_MS=50,a);function a(){}t.WindowUtils=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=(o.parseExpiresIn=function(e){return e=e||"3599",parseInt(e,10)},o.now=function(){return Math.round((new Date).getTime()/1e3)},o);function o(){}t.TimeUtils=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=(i.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),n.__assign({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},i);function i(){}t.ResponseUtils=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(17),o=r(19),i=r(8),a=r(5),s=r(3),c=r(1),u=(l.DetectAuthorityFromUrl=function(e){switch(e=s.UrlUtils.CanonicalizeUri(e),s.UrlUtils.GetUrlComponents(e).PathSegments[0]){case"tfp":return i.AuthorityType.B2C;default:return i.AuthorityType.Aad}},l.CreateInstance=function(e,t){if(c.StringUtils.isEmpty(e))return null;switch(l.DetectAuthorityFromUrl(e)){case i.AuthorityType.B2C:return new o.B2cAuthority(e,t);case i.AuthorityType.Aad:return new n.AadAuthority(e,t);default:throw a.ClientConfigurationErrorMessage.invalidAuthorityType}},l);function l(){}t.AuthorityFactory=u},function(e,t,r){function n(e){return e.telemetryCorrelationId+"-"+e.eventId+"-"+e.eventName}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0).__importDefault(r(39)),i=(a.prototype.startEvent=function(e){if(this.telemetryEmitter){var t=n(e);this.inProgressEvents[t]=e}},a.prototype.stopEvent=function(e){var t=n(e);if(this.telemetryEmitter&&this.inProgressEvents[t]){e.stop(),this.incrementEventCount(e);var r=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(r||[]).concat([e]),delete this.inProgressEvents[t]}},a.prototype.flush=function(e){var t=this;if(this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return t.incrementEventCount(e)});var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var a=new o.default(this.telemetryPlatform,e,this.clientId,i),s=n.concat([a]);this.telemetryEmitter(s.map(function(e){return e.get()}))}}},a.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},a.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(r,n){if(-1===n.indexOf(e))return r;var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])},[])},a);function a(e,t){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=e.platform,this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t}t.default=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0),i=r(9),a=o.__importDefault(r(40)),s=r(23),c=(n=a.default,o.__extends(u,n),u.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},u);function u(e,t,r,o){var a=n.call(this,s.prependEventNamePrefix("default_event"),t)||this;return a.event[s.prependEventNamePrefix("client_id")]=r,a.event[s.prependEventNamePrefix("sdk_plaform")]=e.sdk,a.event[s.prependEventNamePrefix("sdk_version")]=e.sdkVersion,a.event[s.prependEventNamePrefix("application_name")]=e.applicationName,a.event[s.prependEventNamePrefix("application_version")]=e.applicationVersion,a.event[""+i.TELEMETRY_BLOB_EVENT_NAMES.UiEventCountTelemetryBatchKey]=a.getEventCount(s.prependEventNamePrefix("ui_event"),o),a.event[""+i.TELEMETRY_BLOB_EVENT_NAMES.HttpEventCountTelemetryBatchKey]=a.getEventCount(s.prependEventNamePrefix("http_event"),o),a.event[""+i.TELEMETRY_BLOB_EVENT_NAMES.CacheEventCountConstStrKey]=a.getEventCount(s.prependEventNamePrefix("cache_event"),o),a}t.default=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(9),a=r(23),s=r(2),c=(u.prototype.setElapsedTime=function(e){this.event[a.prependEventNamePrefix(i.ELAPSED_TIME_KEY)]=e},u.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp)},Object.defineProperty(u.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"eventName",{get:function(){return this.event[a.prependEventNamePrefix(i.EVENT_NAME_KEY)]},enumerable:!0,configurable:!0}),u.prototype.get=function(){return n.__assign({},this.event,{eventId:this.eventId})},u);function u(e,t){var r;this.startTimestamp=Date.now(),this.eventId=s.CryptoUtils.createNewGuid(),this.event=((r={})[a.prependEventNamePrefix(i.EVENT_NAME_KEY)]=e,r[a.prependEventNamePrefix(i.START_TIME_KEY)]=this.startTimestamp,r[a.prependEventNamePrefix(i.ELAPSED_TIME_KEY)]=-1,r[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=t,r)}t.default=c}],e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=24);function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var t,r}()},"./packages/Microsoft.Office.WebAuth.Implicit/scripts/Implicit.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o,i,a,s,c,u=r("./packages/Microsoft.Office.WebAuth.Implicit/lib/msal.js"),l=!1;function h(e){e.isCallback(window.location.hash)?(a.log("Hash: "+window.location.hash,l),e.handleAuthenticationResponse(),a.log("Completed Hash Handling",l)):e.clearCache()}function d(e,t,r,n,i,a,s){e.Telemetry={idp:o.idp.toLowerCase(),browser:y(),platform:window.navigator.platform,correlationId:t,applicationHost:void 0,applicationId:r,tenantId:o.tenantId?o.tenantId:"",userAgent:window.navigator.userAgent,tokenScope:i||void 0,timeToGetToken:n.ms,errorCodeForGetToken:a||void 0,errorMessageForGetToken:s||void 0}}function p(e){var t=void 0;if(n.some(function(r){return!(!e||!r.applicationId||e.toUpperCase()!==r.applicationId.toUpperCase())&&(t=r.application,!0)}),!t){t=new u.UserAgentApplication({auth:{clientId:e,authority:o.authority,redirectUri:o.redirectUri?o.redirectUri.split("?")[0]:location.href.split("?")[0],navigateToLoginRequestUrl:!o.navigateToLoginRequestUrl||o.navigateToLoginRequestUrl},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0},system:{loadFrameTimeout:o.timeout?o.timeout:6e3}});var r={applicationId:e,application:t};n.push(r)}return t}function f(e){return e.endsWith("/")&&(e=e.substring(0,e.length-1)),e.toUpperCase().startsWith("HTTPS")||g(e)?e+"/.default":e}function g(e){return 36===e.length&&"-"===e.charAt(8)&&"-"===e.charAt(13)&&"-"===e.charAt(18)&&"-"===e.charAt(23)}function y(){var e=[{keyword:"PhantomJS",browserType:i.BrowserType.PhantomJS},{keyword:"Edge",browserType:i.BrowserType.Edge},{keyword:"MSIE",browserType:i.BrowserType.IE},{keyword:"Teams",browserType:i.BrowserType.Teams},{keyword:"Chrome",browserType:i.BrowserType.Chrome},{keyword:"CriOS",browserType:i.BrowserType.Chrome},{keyword:"Firefox",browserType:i.BrowserType.Firefox},{keyword:"Safari",browserType:i.BrowserType.Safari}],t=window.navigator.userAgent.toLowerCase(),r={keyword:"Other",browserType:i.BrowserType.Other};return e.some(function(e){return-1!==t.indexOf(e.keyword.toLowerCase())&&(r=e,!0)}),r.keyword.toString()}function m(e){return o&&o.upn?!(!e||!e.userName||e.userName.toLowerCase()!==o.upn.toLowerCase())||(a.log("Upn in config does not match cached user upn",l),!1):(a.log("Upn does not exist in the configuration, returning true",l),!0)}!function(e){var t=function(){function e(){}return e.Aad="aad",e.Msa="msa",e}();e.IdentityProvider=t;var r=function(){function e(){}return e.RequestAuthConfig="RequestAuthConfig",e.ResponseAuthConfig="ResponseAuthConfig",e.iFramePrefix="msalRenewFrame",e.iFrameIdTokenPrefix="msalIdTokenFrame",e}();e.PostMessageType=r;var n=function(){function e(){}return e.Prod="https://login.microsoftonline.com/",e.Ppe="https://login.windows-ppe.net/",e.AadSuffix="common",e.MsaSuffix="consumers",e}();e.Authority=n,function(e){e[e.IE=0]="IE",e[e.Edge=1]="Edge",e[e.Teams=2]="Teams",e[e.Chrome=3]="Chrome",e[e.Firefox=4]="Firefox",e[e.Safari=5]="Safari",e[e.PhantomJS=6]="PhantomJS",e[e.Other=7]="Other"}(e.BrowserType||(e.BrowserType={}))}(i||(i={})),function(e){function t(e){return!(null!=e&&void 0!==e&&!e)}e.log=function(e,r){return!!t(r)&&(console.log(e),!0)},e.warn=function(e,r){return!!t(r)&&(console.warn(e),!0)},e.error=function(e,r){return!!t(r)&&(console.error(e),!0)}}(a||(a={})),function(e){e.extractAccessToken=function(e){var t=function(e){if("undefined"===e||!e||0===e.length)return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(a.warn("The returned access_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}}(e);if(!t)return null;try{var r=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}(t.JWSPayload);return r?JSON.parse(r):(a.log("The returned access_token could not be base64 url safe decoded."),null)}catch(e){a.error("The returned access_token could not be decoded"+e)}return null}}(s||(s={})),function(e){e.timer=function(){var e=(new Date).getTime();return{get seconds(){return Math.ceil(((new Date).getTime()-e)/1e3)},get ms(){return(new Date).getTime()-e},get formattedSeconds(){return Math.ceil(this.seconds/1e3)+"s"},get formattedMs(){return this.ms+"ms"}}}}(c||(c={})),t.Load=function(e,t){var r=c.timer();(o=e).enableConsoleLogging&&(l=o.enableConsoleLogging),n||window.addEventListener("message",function(e){if(e.origin&&e.origin==location.origin&&e.data&&e.data.iframe&&e.data.request&&e.data.request==i.PostMessageType.RequestAuthConfig){var t=i.PostMessageType.iFramePrefix+e.data.iframe;if(null===(r=document.getElementById(t.replace("+"," ")))){t=i.PostMessageType.iFrameIdTokenPrefix;var r=document.getElementById(t.replace("+"," "))}if(a.log("received from "+t,l),null===r)return void a.log("targetiFrame is null",l);var n=r.contentWindow;null!=n&&(a.log("returning to "+e.data.iframe,l),n.postMessage({request:i.PostMessageType.ResponseAuthConfig,config:o},location.origin))}},!1),o.idp.toLowerCase()===i.IdentityProvider.Msa.toLowerCase()?o.authority?o.authority+=i.Authority.MsaSuffix:o.authority=i.Authority.Prod+i.Authority.MsaSuffix:o.authority?o.authority+=i.Authority.AadSuffix:o.authority=i.Authority.Prod+i.Authority.AadSuffix,n=new Array;for(var s=0,d=o.appIds;s<d.length;s++){var p=d[s];if(p&&g(p)){var f=new u.UserAgentApplication({auth:{clientId:p,authority:o.authority,redirectUri:o.redirectUri?o.redirectUri.split("?")[0]:location.href.split("?")[0],navigateToLoginRequestUrl:!o.navigateToLoginRequestUrl||o.navigateToLoginRequestUrl},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0},system:{loadFrameTimeout:o.timeout?o.timeout:6e3}}),m={applicationId:p,application:f};n.push(m),h(f)}}return{Telemetry:{idp:o.idp.toLowerCase(),browser:y(),platform:window.navigator.platform,correlationId:t||"",loadedApplicationCount:n.length,tenantId:o.tenantId?o.tenantId:"",userAgent:window.navigator.userAgent,timeToLoad:r.ms}}},t.GetToken=function(e,t,r,n){var u=c.timer(),y=p(t);r&&g(r)||(r=void 0);var E={};if(!e)return E.ErrorCode="missing_target",E.ErrorMessage="The provided target for Implicit.GetToken is null, blank or empty",d(E,r,t,u,void 0,E.ErrorCode,E.ErrorMessage),Promise.reject(E);if(!t||!g(t))return E.ErrorCode="invalid_application_ID",E.ErrorMessage="The provided application ID for Implicit.GetToken is null, blank, empty or with invalid format",d(E,r,t,u,void 0,E.ErrorCode,E.ErrorMessage),Promise.reject(E);var C=o.idp.toLowerCase()===i.IdentityProvider.Msa.toLowerCase(),v=[f(e)],I=function(){return new Promise(function(e,n){a.log("Config: "+JSON.stringify(y),l),a.log("application calls acquireTokenSilent",l),y.acquireTokenSilent({scopes:v,loginHint:o.upn,correlationId:r}).then(function(i){var c=i.accessToken;return c&&m(i.account)&&(C||function(e){if(!o||!o.upn)return a.log("Upn does not exist in the configuration, returning true",l),!0;var t=s.extractAccessToken(e);return!!(!t||t&&t.upn&&t.upn.toLowerCase()===o.upn.toLowerCase())||(a.log("provided Upn does not match Upn extracted from token",l),!1)}(c))?(a.log("acquireToken->token: "+c,l),E.Token=c,d(E,r,t,u,v),e(E)):(E.ErrorCode="upn_mismatch",E.ErrorMessage="upn doesn't match with given upn in config",d(E,r,t,u,v,E.ErrorCode,E.ErrorMessage),a.log("acquireToken->error: "+E.ErrorMessage,l),y.clearCache(),n(E))}).catch(function(e){return E.ErrorCode=e.errorCode,E.ErrorMessage=e.errorMessage,d(E,r,t,u,v,e.errorCode,e.errorMessage),a.log("acquireToken->error: "+E.ErrorMessage,l),y.clearCache(),n(E)})})};return n?(a.log("Logging in",l),y.authResponseCallback=function(){h(y)},y.loginPopup({scopes:v,loginHint:o.upn,correlationId:r}).catch(function(e){return y.clearCache(),Promise.reject(e)})).catch(function(e){return a.log("loginPopup->error: "+e.errorMessage,l),E.ErrorCode=e.errorCode,E.ErrorMessage=e.errorMessage,d(E,r,t,u,v,e.errorCode,e.errorMessage),Promise.reject(E)}).then(I):I()},t.CheckUpnMatchIdToken=function(e,t){var r=c.timer(),n={};if(!e||!g(e))return n.ErrorCode="invalid_application_ID",n.ErrorMessage="The provided application ID for Implicit.CheckUpnMatchIdToken is null, blank, empty or with invalid format",n.Telemetry={idp:o.idp.toLowerCase(),browser:y(),platform:window.navigator.platform,correlationId:t,applicationHost:void 0,applicationId:e,tenantId:o.tenantId?o.tenantId:"",tokenScope:[e],timeToCheckUPN:r.ms,errorCodeForCheckUPN:n.ErrorCode,errorMessageForCheckUPN:n.ErrorMessage},Promise.reject(n);var i=p(e),s=[i.config.auth.clientId];return new Promise(function(c,u){a.log("Config: "+JSON.stringify(i),l),a.log("application calls acquireTokenSilent",l),i.acquireTokenSilent({scopes:s,loginHint:o.upn,correlationId:t}).then(function(i){if(n.IsUpnMatch=m(i.account),n.IsUpnMatch)return n.Telemetry={idp:o.idp.toLowerCase(),browser:y(),platform:window.navigator.platform,correlationId:t,applicationHost:void 0,applicationId:e,tenantId:o.tenantId?o.tenantId:"",tokenScope:s,timeToCheckUPN:r.ms},c(n)}).catch(function(i){return n.ErrorCode=i.errorCode,n.ErrorMessage=i.errorMessage,a.log("acquireToken->error: "+n.ErrorMessage,l),n.IsUpnMatch=!1,n.Telemetry={idp:o.idp.toLowerCase(),browser:y(),platform:window.navigator.platform,correlationId:t,applicationHost:void 0,applicationId:e,tenantId:o.tenantId?o.tenantId:"",tokenScope:s,timeToCheckUPN:r.ms,errorCodeForCheckUPN:i.errorCode,errorMessageForCheckUPN:i.errorMessage},u(n)})})},t.GetAuthConfig=function(){return new Promise(function(e,t){new Promise(function(e,t){if(window.location.hash){var r=window.location.hash;r.indexOf("#/")>-1?r=r.substring(r.indexOf("#/")+2):r.indexOf("#")>-1&&(r=r.substring(1));for(var n=r.split("&"),o=0;o<n.length;o++){var i=n[o].split("=");if("state"==decodeURIComponent(i[0])){var a=decodeURIComponent(i[1]).split("|");2==a.length&&e(a[1])}}}t()}).then(function(t){window.addEventListener("message",function(t){t.origin&&t.origin==location.origin&&t.data&&t.data.config&&t.data.request&&t.data.request==i.PostMessageType.ResponseAuthConfig&&e(t.data.config)},!1),parent.postMessage({request:i.PostMessageType.RequestAuthConfig,iframe:t},location.origin)},function(){t({})})})},t.Logout=function(){n.forEach(function(e){a.log("application calls logOut",l),e.application.logOut()}),n=new Array}},0:function(e,t,r){r("./packages/Microsoft.Office.WebAuth.Implicit/lib/msal.min.js"),e.exports=r("./packages/Microsoft.Office.WebAuth.Implicit/scripts/Implicit.ts")}});